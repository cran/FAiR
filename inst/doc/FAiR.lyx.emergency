#LyX 1.6.0svn created this file. For more info see http://www.lyx.org/
\lyxformat 338
\begin_document
\begin_header
\textclass literate-article
\begin_preamble
% Meta information - fill between {} and do not remove %
% \VignetteIndexEntry{Factor Analysis in R}
% \VignetteDepends{FAiR}
% \VignetteKeywords{models, multivariate}
% \VignettePackage{FAiR}
\usepackage{fullpage}
\usepackage{times}
\usepackage{ulem}
\end_preamble
\language english
\inputencoding auto
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 0
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Title
FA
\begin_inset Formula $i$
\end_inset

R Brain Dump
\end_layout

\begin_layout Author
Ben Goodrich
\end_layout

\begin_layout Standard

\series bold
This vignette is intended to be a quick reference that defines terms and
 illustrates how to use the pop-up menus.
 Large parts will not make a great deal of sense outside the introduction
 to SEFA and lexical optimization in Goodrich (2008a) and Goodrich (2008b).
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Notation
\end_layout

\begin_layout Standard
Some notation is provided so that the reader can refer back to it.
 For simplicity, I usually do not distinguish the notation for a population
 parameter from the notation for an estimate of that population parameter
 here.
 In particular, note that all models currently in FA
\begin_inset Formula $i$
\end_inset

R utilize an 
\begin_inset Quotes eld
\end_inset

embedded correlation
\begin_inset Quotes erd
\end_inset

 parameterization.
\end_layout

\begin_layout Itemize
\begin_inset Formula $n$
\end_inset

 is the number of outcome variables, which are indexed by 
\begin_inset Formula $j$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Sigma}$
\end_inset

 is the 
\begin_inset Formula $n\times n$
\end_inset

 covariance matrix among outcomes in the population
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{S}$
\end_inset

 is the 
\begin_inset Formula $n\times n$
\end_inset

 covariance matrix among outcomes in the sample
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{s}=\textrm{vecs}\left(\mathbf{S}\right)$
\end_inset

 stacks the elements below and including the diagonal of 
\begin_inset Formula $\mathbf{S}$
\end_inset

 into a vector of length 
\begin_inset Formula $n^{\ast}=0.5n\left(n+1\right)$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Gamma}=\textrm{acov}\left(\mathbf{s}\right)$
\end_inset

 is the asymptotic covariance of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $r$
\end_inset

 is the number of factors, which are indexed by 
\begin_inset Formula $p$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 is the 
\begin_inset Formula $n\times r$
\end_inset

 primary pattern matrix with one column for each factor
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 is the 
\begin_inset Formula $r\times r$
\end_inset

 correlation matrix among primary factors
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 is used to indicate the primary pattern matrix only if 
\begin_inset Formula $\boldsymbol{\Phi}=\mathbf{I}_{r}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{R}^{\ast}=\boldsymbol{\beta}\boldsymbol{\Phi}\boldsymbol{\beta}^{\prime}$
\end_inset

 is the reduced correlation matrix with communalities along the diagonal,
 denoted by 
\begin_inset Formula $h_{j}^{2}=R_{jj}^{\ast}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Theta}^{2}$
\end_inset

 is the 
\begin_inset Formula $n\times n$
\end_inset

 diagonal (for now) covariance matrix among unique factors such that 
\begin_inset Formula $\Theta_{jj}^{2}=1-h_{j}^{2}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{R}=\mathbf{R}^{\ast}+\boldsymbol{\Theta}^{2}=\boldsymbol{\beta}\boldsymbol{\Phi}\boldsymbol{\beta}^{\prime}+\boldsymbol{\Theta}^{2}$
\end_inset

 is the 
\begin_inset Formula $n\times n$
\end_inset

 reproduced correlation matrix with ones along the diagonal
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Omega}$
\end_inset

 is the 
\begin_inset Formula $n\times n$
\end_inset

 diagonal matrix of standard deviations of the manifest variables to be
 estimated generally
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{C}=\boldsymbol{\Omega}\mathbf{R}\boldsymbol{\Omega}=\boldsymbol{\Omega}\left(\boldsymbol{\beta\Phi\beta}^{\prime}+\boldsymbol{\Theta}^{2}\right)\boldsymbol{\Omega}$
\end_inset

 is the 
\begin_inset Formula $n\times n$
\end_inset

 reproduced covariance matrix and also the expectation of 
\begin_inset Formula $\mathbf{S}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{c}=\textrm{vecs}\left(\mathbf{C}\right)$
\end_inset

 stacks the elements below and including the diagonal of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 into a vector of length 
\begin_inset Formula $n^{\ast}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Pi}=\boldsymbol{\beta\boldsymbol{\Phi}}$
\end_inset

 is the 
\begin_inset Formula $n\times r$
\end_inset

 primary structure matrix of correlations between outcome variables and
 factors
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Game}=\boldsymbol{\beta}\times\boldsymbol{\Pi}$
\end_inset

 is the 
\begin_inset Formula $n\times r$
\end_inset

 factor contribution matrix, where 
\begin_inset Formula $\times$
\end_inset

 indicates element-by-element multiplication
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{D}=\left[\textrm{Diag}\left(\boldsymbol{\Phi}^{-1}\right)\right]^{-\frac{1}{2}}$
\end_inset

 is the 
\begin_inset Formula $r\times r$
\end_inset

 correlation matrix between primary and reference factors
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Psi}=\mathbf{D}\boldsymbol{\Phi}^{-1}\mathbf{D}$
\end_inset

 is the 
\begin_inset Formula $r\times r$
\end_inset

 correlation matrix among reference factors
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Upsilon}=\boldsymbol{\beta}\mathbf{D}$
\end_inset

 is the 
\begin_inset Formula $n\times r$
\end_inset

 reference structure matrix
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Phi}=\boldsymbol{\ddot{\beta}\ddot{\Phi}\ddot{\beta}}^{\prime}+\ddot{\boldsymbol{\Theta}}^{2}$
\end_inset

 is the 
\begin_inset Formula $\ddot{r}\times\ddot{r}$
\end_inset

 equation for the primary factor correlation as a function of second-order
 parameters
\end_layout

\begin_layout Standard
In general, the
\begin_inset space ~
\end_inset


\begin_inset Formula $\ddot{}$
\end_inset


\begin_inset space ~
\end_inset

 notation indicates that the parameter pertains to level 2 of the model
 (if a two-level model is specified).
 The R code in FA
\begin_inset Formula $i$
\end_inset

R uses the same notational conventions at level 1, but uses different symbols
 at level 2.
 The primary pattern coefficient at level two is called 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Delta}
\end_layout

\end_inset

 and the correlation matrix among factors at level two is called 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Xi}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Discrepancy functions in FA
\begin_inset Formula $i$
\end_inset

R
\end_layout

\begin_layout Standard
This section defines the discrepancy functions that can be specified in
 the call to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions}
\end_layout

\end_inset

.
 If you prefer to read good documentation, see the first section of 
\begin_inset CommandInset href
LatexCommand href
name "this part of the LISREL documentation"
target "http://www.ssicentral.com/lisrel/techdocs/rsechisq.pdf"

\end_inset

.
 FA
\begin_inset Formula $i$
\end_inset

R is attempting to do the same calculations (with some differences in notation),
 although FA
\begin_inset Formula $i$
\end_inset

R does not do unweighted least squares or generalized least squares or multisamp
le models (yet).
 
\end_layout

\begin_layout Standard
The main discrepancy functions used in FA
\begin_inset Formula $i$
\end_inset

R are
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{eqnarray*}
F_{ML} & = & \ln\left|\mathbf{C}\right|-\ln\left|\mathbf{S}\right|+\textrm{tr}\left(\mathbf{S}\mathbf{C}^{-1}\right)-n,\\
F_{ADF} & = & \left(\mathbf{s}-\mathbf{c}\right)^{\prime}\boldsymbol{\Gamma}^{-1}\left(\mathbf{s}-\mathbf{c}\right),\end{eqnarray*}

\end_inset

The first, 
\begin_inset Formula $F_{ML}$
\end_inset

, is the maximum likelihood discrepancy function that is familiar in the
 literature and is used exclusively by the previously-existing R functions
 for factor analysis 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{factanal}
\end_layout

\end_inset

 and by 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{sem}
\end_layout

\end_inset

.
 One of the sources of added value in FA
\begin_inset Formula $i$
\end_inset

R is that users are not limited to 
\begin_inset Formula $F_{ML}$
\end_inset

 which presumes that the data are multivariate normal.
 Another reason to prefer 
\begin_inset Formula $F_{ML}$
\end_inset

 is that it is a scale invariant function in the case of EFA and in the
 case of SEFA and CFA if the only exact restrictions are exclusion restrictions.
 However, as was stated in the Notation section, FA
\begin_inset Formula $i$
\end_inset

R utilizes an 
\begin_inset Quotes eld
\end_inset

embedded correlation
\begin_inset Quotes erd
\end_inset

 parameterization, i.e.
 
\begin_inset Formula $\mathbf{C}=\boldsymbol{\Omega}\left(\boldsymbol{\beta\Phi\beta}^{\prime}+\boldsymbol{\Theta}^{2}\right)\boldsymbol{\Omega}$
\end_inset

, which implies that 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Theta}^{2}$
\end_inset

 will take the same values regardless of the scale on which the outcome
 variables are measured.
\end_layout

\begin_layout Standard
The second, 
\begin_inset Formula $F_{ADF}$
\end_inset

, is the 
\begin_inset Quotes eld
\end_inset

asymptotically distribution free
\begin_inset Quotes erd
\end_inset

 discrepancy function and is also relatively well-known in the literature
 (see Browne 1982 and Browne 1984), although not previously available in
 R.
 There are a variety of ways to calculate 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

, depending on the assumptions one wants to make about the data.
 Several of which are discussed in Bentler and Durgeon (1996) and are implemente
d in FA
\begin_inset Formula $i$
\end_inset

R.
 
\end_layout

\begin_layout Standard
In general, assuming the eighth-order moments of the data are finite 
\begin_inset Formula \begin{eqnarray*}
\Gamma_{ij,kl} & = & \sigma_{ijkl}-\sigma_{ij}\sigma_{kl},\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $\sigma_{ijkl}$
\end_inset

 is the fourth-order central moment.
 By default, 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

 is calculated with a (biased) maximum likelihood estimator.
 Let 
\begin_inset Formula $\mathbf{y}_{t}$
\end_inset

 be a row vector of 
\begin_inset Formula $n$
\end_inset

 observed manifest variables for the 
\begin_inset Formula $t$
\end_inset

th unit of observation that are deviated from the sample means of the 
\begin_inset Formula $n$
\end_inset

 variables.
 Let 
\begin_inset Formula $\mathbf{z}_{t}=\textrm{vecs}\left(\mathbf{y}_{t}^{\prime}\mathbf{y}_{t}\right)$
\end_inset

 be a vector of length 
\begin_inset Formula $n^{\ast}$
\end_inset

.
 Then, 
\begin_inset Formula $\mathbf{s}$
\end_inset

 is a vector of column means of 
\begin_inset Formula $\mathbf{Z}$
\end_inset

, which is a matrix that stacks these 
\begin_inset Formula $N$
\end_inset

 vectors and 
\begin_inset Formula $\widehat{\boldsymbol{\Gamma}}=\textrm{cov}\left(\mathbf{Z}\right)$
\end_inset

, where 
\begin_inset Formula $N$
\end_inset

 is used as the divisor instead of 
\begin_inset Formula $N-1$
\end_inset

.
 This formula is equivalent to that in Bentler and Dudgeon (1996), except
 
\begin_inset Formula $N-1$
\end_inset

 is used in calculating 
\begin_inset Formula $\mathbf{s}$
\end_inset

 there.
\end_layout

\begin_layout Standard
including calculating 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

 with no assumptions about the data except finite eigth moments, assuming
 the data have any elliptical distribution (i.e.
 homogenous kurtosis) or assuming the data have heterogenous kurtosis.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The ones in FA
\begin_inset Formula $i$
\end_inset

R differ from those in Bentler and Durgeon (1996) only in that FA
\begin_inset Formula $i$
\end_inset

R normalizes by 
\begin_inset Formula $N$
\end_inset

 rather than 
\begin_inset Formula $N-1$
\end_inset

, which is a neglibile difference in large samples.
\end_layout

\end_inset

 FA
\begin_inset Formula $i$
\end_inset

R also includes a 
\begin_inset Quotes eld
\end_inset

shrunk heterogenous kurtosis
\begin_inset Quotes erd
\end_inset

 discrepancy function, where the kurtoses are heterogenous but 
\begin_inset Quotes eld
\end_inset

shrunk
\begin_inset Quotes erd
\end_inset

 towards the median kurtosis estimate using an extension of the ideas in
 the corpcor package.
 Finally, if the data include ordinal variables and the user chooses not
 to bootstrap 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

, then 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

 is taken to be diagonal, on the basis of the standard errors produced by
 the hetcor package.
 This discrepancy function is sometimes known is 
\begin_inset Quotes eld
\end_inset

diagonally-weighted least squares
\begin_inset Quotes erd
\end_inset

 (DWLS).
 There is more information about estimating 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

 in sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:make_manifest"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:more-discrepancy"

\end_inset

.
\end_layout

\begin_layout Standard
There is another objective function based on the one in Yates (1987) that
 is not formally a discrepancy function.
 It probably should not be used without further refinement.
\end_layout

\begin_layout Section
Using 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_manifest()}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:make_manifest"

\end_inset


\end_layout

\begin_layout Standard
To estimate a factor analysis model, it is first necessary to obtain an
 estimate of 
\begin_inset Formula $\boldsymbol{\Sigma}$
\end_inset

 from the data, denoted 
\begin_inset Formula $\mathbf{S}$
\end_inset

.
 The most common estimator is the unbiased one, which is simply equal to
 the inner products of pairs of centered variables, divided by 
\begin_inset Formula $N-1$
\end_inset

.
 The maximum likelihood estimator is similar but divides by 
\begin_inset Formula $N$
\end_inset

 instead.
 Either is appropriate under ideal conditions, but such conditions are rare.
 Hence, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_manifest()}
\end_layout

\end_inset

 has several alternative estimators of 
\begin_inset Formula $\boldsymbol{\Sigma}$
\end_inset

.
 
\end_layout

\begin_layout Standard
If you do not like the options 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_manifest()}
\end_layout

\end_inset

 provides, you can estimate 
\begin_inset Formula $\boldsymbol{\Sigma}$
\end_inset

 however you like and pass the resulting 
\begin_inset Formula $\mathbf{S}$
\end_inset

 to the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{covmat}
\end_layout

\end_inset

 argument of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_manifest()}
\end_layout

\end_inset

.
 If 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{covmat}
\end_layout

\end_inset

 is a list (where 
\begin_inset Formula $\mathbf{S}$
\end_inset

 would be an element named 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{cov}
\end_layout

\end_inset

), it can also contain an element named 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{W}
\end_layout

\end_inset

, which is an estimate for 
\begin_inset Formula $\boldsymbol{\Gamma}^{-1}$
\end_inset

 to be used with 
\begin_inset Formula $F_{ADF}$
\end_inset

.
 Hopefully, this mechanism will rarely need to be used because FA
\begin_inset Formula $i$
\end_inset

R can estimate 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

 several ways, provided that the raw data are available.
\end_layout

\begin_layout Standard
This idea is similar to the shrinkage estimator of 
\begin_inset Formula $\boldsymbol{\Sigma}$
\end_inset

 in (), which is implemented in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{cov.shrink}
\end_layout

\end_inset

 function in the corpcor library.
 Let 
\begin_inset Formula \begin{eqnarray*}
\widehat{\lambda}_{1}^{\ast} & =\min & \left(1,\frac{\sum_{i\neq j}\widehat{var}\left(r_{ij}\right)}{\sum_{i\neq j}r_{ij}^{2}}\right),\\
\widehat{\lambda}_{2}^{\ast} & =\min & \left(1,\frac{\sum_{i=1}^{n}\widehat{var}\left(v_{i}\right)}{\sum_{i=l}^{n}\left(v_{i}-v_{m}\right)^{2}}\right),\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $r_{ij}$
\end_inset

 is an unbiased sample correlation estimate and 
\begin_inset Formula $v_{i}$
\end_inset

 is an unbiased sample variance estimate and 
\begin_inset Formula $v_{m}$
\end_inset

 is the median of these variance estimates.
 Then, 
\begin_inset Formula \begin{eqnarray*}
r_{ij}^{\ast} & = & \left(1-\widehat{\lambda}_{1}^{\ast}\right)r_{ij},\\
v_{i}^{\ast} & = & \widehat{\lambda}_{2}^{\ast}v_{m}+\left(1-\widehat{\lambda}_{2}^{\ast}\right)v_{i},\\
s_{ij}^{\ast} & = & \frac{r_{ij}^{\ast}}{\sqrt{v_{i}^{\ast}v_{j}^{\ast}}}.\end{eqnarray*}

\end_inset

This estimator of 
\begin_inset Formula $\boldsymbol{\Sigma}$
\end_inset

 can be obtained by specifying 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{how = "lambda"}
\end_layout

\end_inset

 in the call to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_manifest}
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
Esoteric definitions
\begin_inset CommandInset label
LatexCommand label
name "sec:definitions"

\end_inset


\end_layout

\begin_layout Standard
Aside from the discrepancy functions and test statistics, FA
\begin_inset Formula $i$
\end_inset

R differs from the implementation described in other software manuals, textbooks
, etc.
 Thus, it is important to highlight three concepts that are perhaps not
 well-known among factor analysts.
\end_layout

\begin_layout Subsection
The factor contribution matrix
\end_layout

\begin_layout Standard
As stated in the Notation section, the factor contribution matrix is defined
 (see White 1966 and Yates 1987) as the element-by-element product of a
 pattern and a structure matrix, i.e.
 
\begin_inset Formula $\boldsymbol{\Game}=\boldsymbol{\beta}\times\boldsymbol{\Pi}$
\end_inset

, where 
\begin_inset Formula $\boldsymbol{\Pi}=\boldsymbol{\beta}\boldsymbol{\Phi}$
\end_inset

, and similarly for level two.
 Hence if 
\begin_inset Formula $\beta_{jp}=0$
\end_inset

, then 
\begin_inset Formula $\Game_{jp}=0$
\end_inset

, but 
\begin_inset Formula $\Pi_{jp}=0$
\end_inset

 also implies 
\begin_inset Formula $\Game_{jp}=0$
\end_inset

.
\end_layout

\begin_layout Standard
Each row of 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 sums to the communality of the corresponding outcome variable.
 As White (1966) notes, each cell of 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 
\begin_inset Quotes eld
\end_inset

represents the proportion of variance on test 
\begin_inset Formula $j$
\end_inset

 associated with variation on factor 
\begin_inset Formula $p$
\end_inset

.
 Specifically, it is the decrement of [variance in the 
\begin_inset Formula $j$
\end_inset

th outcome variable] which would occur if the [
\begin_inset Formula $p$
\end_inset

th factor were] dropped from the specification 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
dots
\end_layout

\end_inset

 without adjusting the factor loadings on the other factors.
 (375)
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Standard
The factor contribution matrix was originally derived because some thought
 it would aid in the interpretation of factors.
 The interpretation of 
\begin_inset Formula $\Game_{jp}$
\end_inset

 is straightforward, since it is just the correlation between the 
\begin_inset Formula $j$
\end_inset

th outcome and the 
\begin_inset Formula $p$
\end_inset

th factor, weighted by 
\begin_inset Formula $\beta_{jp}$
\end_inset

 .
 Also, the column-wise sums of 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 provide a measure of the 
\begin_inset Quotes eld
\end_inset

strength
\begin_inset Quotes erd
\end_inset

 of the 
\begin_inset Formula $p$
\end_inset

th factor in the battery; in fact, by default the factors produced by 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{summary(*)}
\end_layout

\end_inset

 are presented in decreasing order of the column-wise sums of 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

.
 This matrix of factor contributions can be extracted for interpretation
 using 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{loadings(*, matrix = "FC")}
\end_layout

\end_inset

 but has additional roles in FA
\begin_inset Formula $i$
\end_inset

R.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $r>1$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Phi}\neq\mathbf{I}$
\end_inset

, then any cell of 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 can be negative, which as Yates (1987) notes, implies that the 
\begin_inset Formula $p$
\end_inset

th factor is a negative suppressor variable for the 
\begin_inset Formula $j$
\end_inset

th outcome and has negative weighted validity (Congdon 1972).
 Conversely, we could say that outcome 
\begin_inset Formula $j$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

best
\begin_inset Quotes erd
\end_inset

 indicator (in the sense of having the most weighted validity) of factor
 
\begin_inset Formula $p$
\end_inset

 if 
\begin_inset Formula $\Game_{jp}=\max\left(\boldsymbol{\Game}_{p}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
As discussed below, many restrictions that can be imposed on a factor analysis
 model are defined with respect to 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 in FA
\begin_inset Formula $i$
\end_inset

R, rather than with respect to 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 Also, following a suggestion emailed to me by Peter Bentler, it is possible
 to use 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 rather than 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 as the relevant matrix for some analytic transformation criteria for EFA.
\end_layout

\begin_layout Subsection
Generalized variance (GV) and effective variance (EV)
\end_layout

\begin_layout Standard
The generalized variance of a set of variables is a generalization of the
 univariate concept of variance and is defined as the determinant of their
 covariance (or correlation) matrix.
 The GV can be interpreted as the hypervolume of the variables.
 In FA
\begin_inset Formula $i$
\end_inset

R, the relevant matrices are all correlation matrices, and hence the GV
 is defined here on standardized variables.
 For example, 
\begin_inset Formula $\left|\boldsymbol{\Phi}\right|$
\end_inset

 is the GV of the primary factors.
\end_layout

\begin_layout Standard
One limitation of the GV is that it is inappropriate for comparisons between
 sets of variables that are of different sizes.
 Hence, Pe
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
~{n}
\end_layout

\end_inset

a and Rodr
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'{i}
\end_layout

\end_inset

guez (2003) derives the 
\begin_inset Quotes eld
\end_inset

effective variance
\begin_inset Quotes erd
\end_inset

 of a set of variables as the determinant of their covariance matrix raised
 to the power of the reciprocal of their number.
 For example, 
\begin_inset Formula $\left|\boldsymbol{\Phi}\right|^{\frac{1}{r}}$
\end_inset

 is the EV of the primary factors.
 Pe
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
~{n}
\end_layout

\end_inset

a and Rodr
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'{i}
\end_layout

\end_inset

guez (2003) suggests that the EV can be interpreted as the edge-length of
 a hypercube whose volume is the GV of the variables and shows that it is
 a valid metric for comparing dispersion across differently-sized sets of
 variables.
\end_layout

\begin_layout Standard
I have never encountered a paper in the factor analysis literature that
 attempted to interpret a result on the basis of the GV or EV, although
 it is in harmony with the geometric interpretation of the factor analysis
 model.
 Nevertheless, both have important roles in FA
\begin_inset Formula $i$
\end_inset

R because restrictions can be defined on them, particularly in the case
 of the EV.
 Yates (1987) advocates one such restriction, and several more have been
 included in FAiR that are loosely derived from Yates (1987) are discussed
 below.
\end_layout

\begin_layout Section
Important theorems
\end_layout

\begin_layout Standard
The two (three really) theorems discussed in this section are relevant to
 the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{rankcheck}
\end_layout

\end_inset

 argument to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions}
\end_layout

\end_inset

 in CFA and SEFA models.
\end_layout

\begin_layout Subsection
Howe (1955)
\begin_inset CommandInset label
LatexCommand label
name "sub:Howe"

\end_inset


\end_layout

\begin_layout Standard
One theorem from Howe (1955) is somewhat well-known via various works of
 Karl J
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
"{o}
\end_layout

\end_inset

reskog.
 A set of conditions that is sufficient for rotational uniqueness of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 are that 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 is a full-rank correlation matrix
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 has 
\begin_inset Formula $r-1$
\end_inset

 zeros in each column
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 is of rank 
\begin_inset Formula $r-1$
\end_inset

, where 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 is the submatrix of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 that includes all rows where the 
\begin_inset Formula $p$
\end_inset

th factor is zero
\end_layout

\begin_layout Standard
Bollen and J
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
"{o}
\end_layout

\end_inset

reskog (1985) and Millsap (2001) emphasize that these conditions are insufficien
t for identification of the parameters.
 Rotational uniqueness roughly means that there is no transformation matrix
 (besides the identity matrix) that can post-multiply 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

, leave the zeros in the same positions, and change the values of the nonzeros.
 Identification roughly means that one could uniquely solve for all free
 model parameters if the population 
\begin_inset Formula $\boldsymbol{\Sigma}$
\end_inset

 were available.
\end_layout

\begin_layout Standard
A similar theorem was proven in Koopmans and Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950), although this paper has been more influential in the econometrics
 literature than in the factor analysis literature.
 I think Koopmans and Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950) should be credited with Howe's (1955) result, although it is not
 clear if Howe (1955) was aware of it.
 Koopmans and Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950) shows that if 
\begin_inset Formula $\boldsymbol{\Theta}^{2}$
\end_inset

 is identified and the 
\begin_inset Formula $r-1$
\end_inset

 zeros in 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 are specified in specific cells 
\emph on
a priori
\emph default
, then these conditions are collectively necessary and sufficient for identifica
tion of the free parameters in 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

.
 Various results on conditions for the identification of 
\begin_inset Formula $\boldsymbol{\Theta}^{2}$
\end_inset

 are given in section 4 of Anderson and Rubin (1956) and are not considered
 further here.
 
\end_layout

\begin_layout Standard
The upshot of Koopmans and Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l's (1950) result is that it gives minimal conditions under which a CFA
 model is identified.
 Warnings will be produced if a CFA model appears to be inconsistent with
 these conditions.
\end_layout

\begin_layout Subsection
Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950)
\end_layout

\begin_layout Standard
Koopmans and Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950) also states another important theorem that is more relevant for
 SEFA, although the proofs are given in Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950).
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 is a full-rank correlation matrix
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 has 
\begin_inset Formula $r$
\end_inset

 zeros somewhere in each column (without comitting to where they are located)
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 is of rank 
\begin_inset Formula $r-1\,\forall p$
\end_inset

, where 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 is the submatrix of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 that includes all rows where the 
\begin_inset Formula $p$
\end_inset

th factor is zero
\end_layout

\begin_layout Enumerate
If any row of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 that is not in 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 is appended to 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

, the rank of the resulting matrix is 
\begin_inset Formula $r$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}_{-t}$
\end_inset

 is of rank 
\begin_inset Formula $r-1\,\forall p,t$
\end_inset

, where 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}_{-t}$
\end_inset

 is the submatrix of 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 that excludes the 
\begin_inset Formula $t$
\end_inset

th row
\end_layout

\begin_layout Enumerate
No other 
\begin_inset Formula $r\times r$
\end_inset

 submatrix of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 is of rank 
\begin_inset Formula $r-1$
\end_inset

 besides the 
\begin_inset Formula $\overset{1}{\boldsymbol{\beta}}\dots\overset{r}{\boldsymbol{\beta}}$
\end_inset

 matrices
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\boldsymbol{\Theta}^{2}$
\end_inset

 is identified
\end_layout

\begin_layout Standard
Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950) contains a weaker theorem but is described as 
\begin_inset Quotes eld
\end_inset

less useful
\begin_inset Quotes erd
\end_inset

 and is not considered here (yet).
 It is possible for a SEFA model to enforce conditions 1 and 2 by construction.
 It is also possible for a SEFA model to force 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 and 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}_{-t}$
\end_inset

 to have a maximum possible rank of 
\begin_inset Formula $r-1\,\forall p,t$
\end_inset

.
 Although it is impossible to verify that the ranks of 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 and 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}_{-t}$
\end_inset

 are not less than 
\begin_inset Formula $r-1$
\end_inset

 without knowing their population values and likewise impossible to verify
 conditions 4 and 6 without population knowledge, we usually are not too
 concerned with such corner cases.
\end_layout

\begin_layout Standard
The upshot of Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l's (1950) theorem is that it provides minimal (albeit extensive) conditions
 for identification in SEFA models where the number of zeros in the 
\begin_inset Formula $p$
\end_inset

th column of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 is specified but not their locations.
 Hence, the prototype value for the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{rankcheck}
\end_layout

\end_inset

 slot of an object that inherits from class 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{paramter.coef.SEFA}
\end_layout

\end_inset

 is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{"reiersol"}
\end_layout

\end_inset

 for SEFA models and warnings will be produced if the model appears to be
 unidentified.
 It is possible that identification could plausibly be asserted under various
 weaker conditions, particularly if inequality restrictions are used to
 preclude some otherwise duplicative solutions.
 However, departures from Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l's (1950) theorem would have to be considered on a case-by-case basis.
\end_layout

\begin_layout Section
SEFA or CFA via 
\family typewriter
Factanal()
\end_layout

\begin_layout Standard
In this example, I will use a covariance matrix containing 24 mental tests
 used by Harman (1976) and originally by Holzinger.
 Execute 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{?Harman74.cor}
\end_layout

\end_inset

 to see more information about it, but it is just a fairly standard and
 well-known mental test example.
\end_layout

\begin_layout Standard

\series bold
WARNING: The editable menus are kept small in this vignette; it may be necessary
 to resize the editor window or scroll to access all the cells of the matrix
 you intend to edit.
 Also, note that changes to a cell do not 
\begin_inset Quotes eld
\end_inset

register
\begin_inset Quotes erd
\end_inset

 until you press enter, tab, arrow, etc.
 If you have an 
\begin_inset Quotes eld
\end_inset

unregistered
\begin_inset Quotes erd
\end_inset

 change and click OK, that change will be ignored.
 Also, if you click Cancel, the function aborts rather than reverts to the
 previous menu.
\end_layout

\begin_layout Standard
To start this sequence, I typed the commands 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
Rcode{library(FAiR)}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
Rcode{man <- make
\backslash
_manifest(covmat = Harman74.cor)}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
Rcode{res <- make
\backslash
_restrictions(manifest = man, model = "SEFA")}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
More on discrepancy functions
\begin_inset CommandInset label
LatexCommand label
name "sub:more-discrepancy"

\end_inset


\end_layout

\begin_layout Standard
Bentler and Dudgeon (1996) also has formulae for the elliptical and heterogenous
 kurtosis estimators of 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

.
 In the heterogenous kurtosis case 
\begin_inset Formula \begin{eqnarray*}
\sigma_{ij,kl} & = & \left(a_{ij}a_{kl}\right)\sigma_{ij}\sigma_{kl}+\left(a_{ik}a_{jl}\right)\sigma_{ik}\sigma_{jl}+\left(a_{il}a_{jk}\right)\sigma_{il}\sigma_{jk},\\
a_{ij} & = & \frac{\kappa_{i}+\kappa_{j}}{2},\\
\kappa_{i} & = & \sqrt{\frac{\sum_{t=1}^{N}\left(y_{ti}\right)^{4}}{3\sum_{t=1}^{N}\left(y_{ti}\right)^{2}}}.\end{eqnarray*}

\end_inset

If 
\begin_inset Formula $\kappa_{i}=\kappa\,\forall i$
\end_inset

, then the elliptical case results, and if 
\begin_inset Formula $\kappa_{i}=1\,\forall i$
\end_inset

, the multivariate normal case results.
 FA
\begin_inset Formula $i$
\end_inset

R includes a 
\begin_inset Quotes eld
\end_inset

shrunk heterogenous kurtosis
\begin_inset Quotes erd
\end_inset

 estimator that shrinks each 
\begin_inset Formula $\kappa_{i}$
\end_inset

.
 
\end_layout

\begin_layout Standard
When this idea is applied to the 
\begin_inset Quotes eld
\end_inset

shrunk heterogenous kurtosis
\begin_inset Quotes erd
\end_inset

 estimator of 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

, 
\begin_inset Formula \begin{eqnarray*}
\kappa_{i} & = & \sqrt{\frac{\sum_{t=1}^{N}\left(y_{ti}\right)^{4}}{3\sum_{t=1}^{N}\left(y_{ti}\right)^{2}}}\\
\widehat{\lambda}_{2}^{\ast} & = & \min\left(1,\frac{\sum_{k=1}^{n}\widehat{var}\left(\kappa_{i}\right)}{\sum_{k=l}^{n}\left(\kappa_{i}-\kappa_{m}\right)^{2}}\right),\\
\kappa_{i}^{\ast} & = & \widehat{\lambda}_{2}^{\ast}\kappa_{m}+\left(1-\widehat{\lambda}_{2}^{\ast}\right)\kappa_{i},\end{eqnarray*}

\end_inset

and 
\begin_inset Formula $a_{ij}^{\ast}=\frac{\kappa_{i}^{\ast}+\kappa_{j}^{\ast}}{2}$
\end_inset

 in the estimate of 
\begin_inset Formula $\boldsymbol{\Gamma}$
\end_inset

.
 If 
\begin_inset Formula $\widehat{\lambda}_{2}^{\ast}=1$
\end_inset

, then something quite similar to the elliptical estimator would result,
 so FA
\begin_inset Formula $i$
\end_inset

R simply reverts to the elliptical estimator in that case.
\end_layout

\begin_layout Subsection
Number of Factors
\end_layout

\begin_layout Standard
The first questions that will be asked pertain to the number of factors
 and can be avoided if 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{factors}
\end_layout

\end_inset

 were specified explicitly, e.g.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_manifest(manifest = man, factors = c(5,2), model = "SEFA"}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename screenshots2/simultaneous/fivefactors.png
	width 2in

\end_inset


\begin_inset Graphics
	filename screenshots2/simultaneous/yesno.png
	width 2.5in

\end_inset


\begin_inset Graphics
	filename screenshots2/simultaneous/twofactors.png
	width 2in

\end_inset


\end_layout

\begin_layout Standard
Some people may be unfamiliar with the idea of a two-level model; it is
 briefly defined in the Notation section and also in the help page for 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions}
\end_layout

\end_inset

.
 If 
\begin_inset Formula $r\geq3$
\end_inset

, the user will be asked whether to estimate a simultaneous second-order
 model, which decomposes the correlation matrix among first-order primary
 factors 
\begin_inset Formula $\left(\boldsymbol{\Phi}\right)$
\end_inset

 as a function of fewer second-order factors.
 For example, some people define ``general intelligence'' to be the second-order
 factor that drives various first-order (primary) mental abilities.
 
\end_layout

\begin_layout Standard
If a second-order model is estimated, and if 
\begin_inset Formula $r\geq5$
\end_inset

, the user will be asked how many second-order factors 
\begin_inset Formula $\left(\ddot{r}\right)$
\end_inset

 to extract.
 For the sake of completeness, I will assume that the user answered ``Yes''
 to the question of whether a simultaneous second-order model should be
 estimated.
 Then, the dialog asks the user to specify the number of second-order factors
 to extract.
 If 
\begin_inset Formula $r=3$
\end_inset

 or 
\begin_inset Formula $r=4$
\end_inset

, then 
\begin_inset Formula $\ddot{r}$
\end_inset

 can only be one.
 If 
\begin_inset Formula $r=5$
\end_inset

, then 
\begin_inset Formula $\ddot{r}$
\end_inset

 can be one or two.
 If 
\begin_inset Formula $r\geq7$
\end_inset

, then 
\begin_inset Formula $\ddot{r}$
\end_inset

 can be three in a SEFA model.
 Rarely would one need to estimate a model with larger numbers for 
\begin_inset Formula $r$
\end_inset

 and 
\begin_inset Formula $\ddot{r}$
\end_inset

.
 I will assume that the user has chosen 
\begin_inset Formula $\ddot{r}=2$
\end_inset

.
\end_layout

\begin_layout Subsection
Main menu
\end_layout

\begin_layout Standard
The following menu is is critical in the sense that the user will only be
 subsequently asked about options that are checked.
 This menu would have fewer options if there were no simultaneous second-order
 model, or if there were only one second-order factor, or if the model were
 a CFA.
 It is quite possible to check multiple options.
 I will discuss each of these options eventually; however, the order in
 which subsequent options are specified is not necessarily the same order
 that is presented in this menu.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/menunator.png
	width 6.5in

\end_inset


\end_layout

\begin_layout Subsubsection
Fix specific coefficients to particular values (second and eigth checkboxes)
\end_layout

\begin_layout Standard
The figures below illustrate dialogs that ask about pegging specific coefficient
s to particular values 
\emph on
a priori
\emph default
 and hence not estimating them.
 The dialogs for both level two 
\begin_inset Formula $\left(r\times\ddot{r}\right)$
\end_inset

 and level one 
\begin_inset Formula $\left(n\times r\right)$
\end_inset

 are shown simultaneously here but are not actually simultaneously specified
 when using FA
\begin_inset Formula $i$
\end_inset

R.
 Although it is not visably apparent unless the editor window is maximized,
 the dimensions of matrix to be edited are the same as the dimensions of
 the matrix to eventually be estimated, and there is an exact correspondence
 between the cells of the editor window and the cells of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 (or 
\begin_inset Formula $\ddot{\boldsymbol{\beta}}$
\end_inset

 as the case may be).
 This correspondence holds in almost all of the editor windows to follow,
 but this matrix-based interface may not be as intuitive to users who are
 accustomed to specifying SEMs with path diagrams.
 Although this example is a SEFA, these dialogs are more characteristic
 of a CFA model, which requires enough 
\emph on
a priori
\emph default
 zero coefficients to satisfy the theorems discussed in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Howe"

\end_inset

.
 If this were a CFA model, these editing windows would pop up regardless
 of whether the user requested so.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/peg_coefficients/peg_coefficients2.png
	width 3in

\end_inset


\begin_inset Graphics
	filename screenshots2/peg_coefficients/peg_coefficients1.png
	width 3in

\end_inset


\end_layout

\begin_layout Standard
There are several important things to note.
 First, any unrestricted coefficients should be left as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{NA}
\end_layout

\end_inset

.
 In many SEM programs, a coefficient is restricted to be zero unless the
 user specifies otherwise.
 This is 
\emph on
not
\emph default
 the case in FA
\begin_inset Formula $i$
\end_inset

R; if and only if you specify that a coefficient is zero will it be zero
 
\emph on
a priori
\emph default
.
 In a SEFA model, it is possible to leave all cells as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{NA}
\end_layout

\end_inset

, but doing so would generate an error message under a CFA model.
\end_layout

\begin_layout Standard
Second, in many SEM programs it is possible or even customary to specify
 that some coefficient is 
\begin_inset Formula $1.0$
\end_inset

 to normalize the scale of a factor.
 In FA
\begin_inset Formula $i$
\end_inset

R, the user generally should 
\emph on
not
\emph default
 restrict one coefficient per factor to have a coefficient of 
\begin_inset Formula $1.0$
\end_inset

 because the factors are already normalized to have unit variances along
 the diagonal of 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

.
 Hence, to also constrain a coefficient to be 
\begin_inset Formula $1.0$
\end_inset

 would be a substantive restriction rather than merely a normalization.
\end_layout

\begin_layout Standard
Third, if one were to restrict a coefficient to be 
\begin_inset Formula $1.0$
\end_inset

, then one would almost always restrict the other coefficients in that row
 to be 
\begin_inset Formula $0.0$
\end_inset

, in which case the corresponding outcome variable will be treated as 
\begin_inset Quotes eld
\end_inset

exogenous
\begin_inset Quotes erd
\end_inset

 and its standard deviation will be estimated from the data rather than
 by the model.
 Hence, this mechanism (which is apparently all too familiar to long-time
 users of LISREL) can be used for factor analysis where some factors are
 identical to observed manifest variables.
 However, this specification is not generally recommended in FA
\begin_inset Formula $i$
\end_inset

R.
 It is better to exploit a feature of FA
\begin_inset Formula $i$
\end_inset

R (discussed below) to designate some outcome variable as the 
\begin_inset Quotes eld
\end_inset

best
\begin_inset Quotes erd
\end_inset

 (yet imperfect) indicator of a factor.
\end_layout

\begin_layout Standard
Fourth, if one wanted to impose the restriction that some coefficient is
 an exact function of other coefficients (but not the simpler restriction
 that two or more coefficients are equal), then it is necessary to designate
 the 
\begin_inset Quotes eld
\end_inset

fixed
\begin_inset Quotes erd
\end_inset

 coefficient in this dialog and pass a function that enforces these restrictions
 to the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{nl
\backslash
_1}
\end_layout

\end_inset

 or 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{nl
\backslash
_2}
\end_layout

\end_inset

 arguments of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions}
\end_layout

\end_inset

.
 For example, to impose the restriction that the first coefficient on the
 
\begin_inset Quotes eld
\end_inset

Visual Perception
\begin_inset Quotes erd
\end_inset

 test is the ratio of the second and third coefficients, one could proceed
 like this 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{
\backslash

\backslash
foo <- function(x) 
\backslash
{
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

  x[1,1] <- x[1,2] / x[1,3]
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

  return(x)
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
}
\backslash

\backslash
res <- make
\backslash
_restrictions(manifest = man, model = "SEFA", nl
\backslash
_1 = foo)
\backslash

\backslash
}
\end_layout

\end_inset

But it is also necessary to designate 
\begin_inset Formula $\beta_{11}$
\end_inset

 as 
\begin_inset Quotes eld
\end_inset

fixed
\begin_inset Quotes erd
\end_inset

, even though we do not know what number it is fixed to until 
\begin_inset Formula $\beta_{12}$
\end_inset

 and 
\begin_inset Formula $\beta_{13}$
\end_inset

 are specified.
 In such situations, 
\begin_inset Quotes eld
\end_inset

fix
\begin_inset Quotes erd
\end_inset

 coefficients that are exact functions of other coefficients to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Inf}
\end_layout

\end_inset

 (note the capitalization of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Inf}
\end_layout

\end_inset

).
\end_layout

\begin_layout Standard
Fifth, if merely imposing the restriction that two or more coefficients
 are equal to each other, do not pass such a function to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{nl
\backslash
_1}
\end_layout

\end_inset

 or 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{nl
\backslash
_2}
\end_layout

\end_inset

 and do not bother designating affected coefficients as 
\begin_inset Quotes eld
\end_inset

fixed
\begin_inset Quotes erd
\end_inset

 in this dialog.
 Instead, use the dedicated mechanism for imposing equality restrictions,
 which is discussed in the next subsection.
 
\end_layout

\begin_layout Standard
All that said, the most common use of this dialog (particularly for a CFA)
 is to restrict specific coefficients to be 
\begin_inset Formula $0.0$
\end_inset

.
 Simply type 
\begin_inset Formula $0.0$
\end_inset

 in the appropriate cell(s), 
\shape italic
press Enter to make sure the change 
\begin_inset Quotes eld
\end_inset

registers
\begin_inset Quotes erd
\end_inset

 in the editor
\shape default
, and press OK to exit this dialog.
 If restricting a specific coefficient to some number other than 
\begin_inset Formula $0.0$
\end_inset

, keep in mind that the embedded correlation parameterization in FA
\begin_inset Formula $i$
\end_inset

R means that coefficients are calibrated for 
\emph on
standardized
\emph default
 variables.
\end_layout

\begin_layout Subsubsection
Constrain coefficients to be equal to each other (fourth checkbox)
\end_layout

\begin_layout Standard
This figure illustrates the dialog to constrain one or more coefficients
 (at level one) to be equal to each other; the dialog for level two is similar.
 Again, it is not visibly apparent unless the editor window is maximized
 but the dimensions of the matrix to be edited are 
\begin_inset Formula $n\times r$
\end_inset

 just like 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/equalities/equalities.png

\end_inset


\end_layout

\begin_layout Standard
The matrix is initially filled with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{FALSE}
\end_layout

\end_inset

, which is a keyword in R.
 To impose an equality restriction among two or more coefficients, change
 at least two of the cells to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{TRUE}
\end_layout

\end_inset

, which is also a keyword in R.
 
\shape italic
The capitalization is essential
\shape default
.
 For example, to impose the restriction that 
\begin_inset Formula $\beta_{11}=\beta_{21}$
\end_inset

, I would change the first two cells in the first column to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{TRUE}
\end_layout

\end_inset

.
 It is possible to constrain three or more coefficients to all be equal
 to each other by changing three or more cells to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{TRUE}
\end_layout

\end_inset

.
 When all cells that are restricted to be equal to each other are designated
 with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{TRUE}
\end_layout

\end_inset

 in the appropriate cell, click OK.
\end_layout

\begin_layout Standard
At that point, all the cells will be reset to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{FALSE}
\end_layout

\end_inset

, which allows you to impose 
\emph on
another
\emph default
 set of equality restrictions (among a disjoint set of coefficients, e.g.
 
\begin_inset Formula $\beta_{14}=\beta_{15}$
\end_inset

).
 This process can be repeated as many times as is necessary to represent
 all the equality coefficients you want to impose on disjoint sets of coefficien
ts.
 If OK is clicked when all cells remain 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{FALSE}
\end_layout

\end_inset

, then whatever dialogue box is next appears.
\end_layout

\begin_layout Standard
Finally, again recall that the embedded correlation parameterization in
 FA
\begin_inset Formula $i$
\end_inset

R implies that coefficients should be calibrated for standardized variables.
 Hence, constraining two or more cells of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 to be equal does not imply that the corresponding cells of 
\begin_inset Formula $\boldsymbol{\Omega}\boldsymbol{\beta}$
\end_inset

 will be equal.
\end_layout

\begin_layout Subsubsection
Change bounds on coefficients (third checkbox)
\end_layout

\begin_layout Standard
These figures ask about bounds on coefficients at level one, i.e.
 on 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 The dialogue for level two would be similar.
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename screenshots2/bounds_coefficients/sure.png

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/bounds_coefficients/slider.png

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/bounds_coefficients/editor.png

\end_inset


\end_layout

\begin_layout Standard
Specifying bounds on coefficients is a three-stage process.
 First, the user is asked whether to change the lower and / or upper bounds
 from their default values, here 
\begin_inset Formula $\pm1.5$
\end_inset

.
 I only illustrate changing the lower bounds, but the process is similar
 if one wanted to additionally or alternatively change the upper bounds.
\end_layout

\begin_layout Standard
Second, the user is asked for a 
\begin_inset Quotes eld
\end_inset

fill value
\begin_inset Quotes erd
\end_inset

 to use for 
\emph on
most
\emph default
 of the (lower in this case) bounds on coefficients.
 After pressing OK, this value is filled into an editable matrix that is
 of the same dimension as 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

, although that is not obvious when the editor window is not maximized.
 Third, the user can edit any cell of this 
\begin_inset Formula $n\times r$
\end_inset

 matrix to modify the bound for any coefficient.
 Here I leave all lower bounds at my 
\begin_inset Quotes eld
\end_inset

fill value
\begin_inset Quotes erd
\end_inset

 of 
\begin_inset Formula $-0.1$
\end_inset

.
 Thus, this model requires a 
\begin_inset Quotes eld
\end_inset

almost-positive
\begin_inset Quotes erd
\end_inset

 manifold, which is a 
\emph on
substantive
\emph default
 constraint that can be wrong and can be tested.
\end_layout

\begin_layout Standard
Finally, again recall that the embedded correlation parameterization in
 FA
\begin_inset Formula $i$
\end_inset

R implies that coefficients (and hence their bounds) should be calibrated
 for standardized variables.
 In particular, rarely would it be necessary to make the bounds 
\emph on
wider
\emph default
 than 
\begin_inset Formula $\pm1.5$
\end_inset

 because more extreme standardized coefficients are incredibly rare (provided
 that 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 is well-conditioned).
 Moreover, if there were only one factor, it is impossible to make the bounds
 on its coefficients wider than 
\begin_inset Formula $\pm1.0$
\end_inset

.
 If one were to impose the inequality restriction that there are no negative
 suppresor variables (see below), then it is somewhat advantageous to also
 narrow the upper bound on the coefficients to 
\begin_inset Formula $1.0$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Important Note
\end_layout

\begin_layout Standard
The running example is a two-level model.
 In two-level models, one cannot currently impose bounds on the off-diagonals
 of 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 using the pop-up menus.
 However, if this were a one-level model, the next dialog box would ask
 about bounds on the off-diagonals of 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 if such an option were selected from the main menu.
 That dialog would be similar to the one illustrated in subsubsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:bounds_cormat"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Nondefault mapping rule and changing the requisite number of zeros (eleventh
 and twelth checkboxes)
\begin_inset CommandInset label
LatexCommand label
name "sub:mapping_rule"

\end_inset


\end_layout

\begin_layout Standard
In the SEFA model presumed here, the question shown in the figure below
 is very important and pertains to the mapping rule used to squash certain
 cells of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 to zero during the optimization.
 The dialog for level two is similar but generally has fewer options.
 If a CFA model were being estimated, this question would not appear because
 the theorems in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Howe"

\end_inset

 must be satisfied by 
\emph on
a priori
\emph default
 restrictions.
 Specifying a non-default mapping rule is more common for a rather 
\begin_inset Quotes eld
\end_inset

exploratory
\begin_inset Quotes erd
\end_inset

 SEFA; for a more 
\begin_inset Quotes eld
\end_inset

confirmatory
\begin_inset Quotes erd
\end_inset

 SEFA, one would typically accept the default mapping rule and suppliment
 it with other restrictions.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/mapping_rule/sure.png

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $b_{p}$
\end_inset

 be the number of zeros required for the 
\begin_inset Formula $p$
\end_inset

th column of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 Let 
\begin_inset Formula $\underline{\boldsymbol{\beta}}$
\end_inset

 be a matrix with the same dimensions as 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 Suppose the free cells of 
\begin_inset Formula $\underline{\boldsymbol{\beta}}$
\end_inset

 have been filled in by a proposal for the restricted optimum of the discrepancy
 function, but it has fewer than 
\begin_inset Formula $b_{p}$
\end_inset

 zeros in the 
\begin_inset Formula $p$
\end_inset

th column (and possibly no zeros at all).
 The 
\begin_inset Quotes eld
\end_inset

mapping rule
\begin_inset Quotes erd
\end_inset

 maps from 
\begin_inset Formula $\underline{\boldsymbol{\beta}}$
\end_inset

 to 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 by changing some 
\begin_inset Quotes eld
\end_inset

small
\begin_inset Quotes erd
\end_inset

 cells of 
\begin_inset Formula $\underline{\boldsymbol{\beta}}$
\end_inset

 to zero and then the discrepancy function (and each constraint function)
 is evaluated at 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

, not 
\begin_inset Formula $\underline{\boldsymbol{\beta}}$
\end_inset

 .
 By 
\begin_inset Quotes eld
\end_inset

small
\begin_inset Quotes erd
\end_inset

, I always mean in absolute value; however the rules are usually defined
 on the reference structure matrix 
\begin_inset Formula $\left(\underline{\boldsymbol{\Upsilon}}=\underline{\boldsymbol{\beta}}\mathbf{D}\right)$
\end_inset

 or the factor contribution matrix 
\begin_inset Formula $\left(\boldsymbol{\Game}=\underline{\boldsymbol{\beta}}\times\left(\underline{\boldsymbol{\beta}}\boldsymbol{\Phi}\right)\right)$
\end_inset

 , rather than 
\begin_inset Formula $\underline{\boldsymbol{\beta}}$
\end_inset

 itself.
\end_layout

\begin_layout Itemize
``No, I just want plain zeros''.
 This default mapping rule simply squashes the 
\begin_inset Formula $b_{p}$
\end_inset

 smallest elements in 
\begin_inset Formula $\underline{\boldsymbol{\beta}_{p}}$
\end_inset

 to zero.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

At least one zero per factor on a high communality variable.
\begin_inset Quotes erd
\end_inset

 This mapping rule is similar but is slightly more complicated.
 Let 
\begin_inset Formula $\overline{\Game_{j}}=\frac{1}{r}\sum_{p=1}^{r}\underline{\Game_{jp}}=\frac{h^{2}}{r}$
\end_inset

 be the arithmetic mean of the factor contributions for the 
\begin_inset Formula $j$
\end_inset

th outcome variable and let 
\begin_inset Formula $\widetilde{\Game_{j}}=\left(\prod_{j=1}^{r}\underline{\Game_{jp}}\right)^{\frac{1}{r}}$
\end_inset

 be the geometric mean of the factor contributions for the 
\begin_inset Formula $j$
\end_inset

th outcome, which is defined only for outcomes with nonnegative factor contribut
ions.
 Hence, 
\begin_inset Formula $\frac{\overline{\Game_{j}}}{\widetilde{\Game_{j}}}$
\end_inset

 will tend to be more positive when the communality of the 
\begin_inset Formula $j$
\end_inset

th outcome is large but at least one factor contributes little to the communalit
y.
 Define the set of 
\begin_inset Quotes eld
\end_inset

potential zeros
\begin_inset Quotes erd
\end_inset

 on factor 
\begin_inset Formula $p$
\end_inset

 as those rows of 
\begin_inset Formula $\underline{\boldsymbol{\Upsilon}}$
\end_inset

 where 
\begin_inset Formula $\underline{\Upsilon_{jp}}<\underline{\Upsilon_{jq}}\,\forall q\neq p$
\end_inset

.
 For each 
\begin_inset Formula $p$
\end_inset

, this mapping rule squashes 
\begin_inset Formula $\underline{\beta_{jp}}$
\end_inset

 to zero for the outcome among the set of 
\begin_inset Quotes eld
\end_inset

potential zeros
\begin_inset Quotes erd
\end_inset

 with the largest (well-defined) 
\begin_inset Formula $\frac{\overline{\Game_{j}}}{\widetilde{\Game_{j}}}$
\end_inset

.
 The default mapping rule is then applied to squash 
\begin_inset Formula $b_{p}-1$
\end_inset

 more cells to zero for the 
\begin_inset Formula $p$
\end_inset

th factor.
\end_layout

\begin_layout Itemize
``Encourage cohyperplanrity (revisionist Yates 1987)''.
 This very promising mapping rule squashes 
\begin_inset Formula $r-1$
\end_inset

 cells in the 
\begin_inset Formula $p$
\end_inset

th column of 
\begin_inset Formula $\underline{\boldsymbol{\beta}}$
\end_inset

 using the following piecewise function 
\begin_inset Formula $\forall q\neq p$
\end_inset

:
\begin_inset Formula \begin{eqnarray*}
\beta_{jp} & = & \begin{cases}
0 & \textrm{if}\,\underline{\Game_{jq}}-\underline{\Game_{jp}}=\max\left\{ \underline{\boldsymbol{\Game}_{q}}-\underline{\boldsymbol{\Game}_{p}}\right\} \\
\underline{\beta_{jp}} & \textrm{otherwise,}\end{cases}\end{eqnarray*}

\end_inset

which tends to place the zeros for the 
\begin_inset Formula $p$
\end_inset

th column of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 in the rows where the factor contribution of the 
\begin_inset Formula $q$
\end_inset

th factor is large.
 The default mapping rule is then applied to squash 
\begin_inset Formula $b_{p}-\left(r-1\right)$
\end_inset

 more cells to zero for the 
\begin_inset Formula $p$
\end_inset

th factor.
 Although Yates (1987) did not anticipate SEFA, it repeatedly recommends
 procedures that tend to encourage outcomes within hyperplanes in the common
 factor space to be widely dispersed throughout their hyperplane(s).
 This mapping rule attempts to do so.
\end_layout

\begin_layout Itemize
``
\begin_inset Formula $r$
\end_inset

 outcomes of complexity 
\begin_inset Formula $r-1$
\end_inset

 for each factor (weaker Thurstone)''.
 This mapping rule is similar to the default mapping rule in that 
\begin_inset Formula $r$
\end_inset

 small elements in the 
\begin_inset Formula $p$
\end_inset

th column of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 are squashed to zero, except that there is an additional stipulation that
 no outcome is of complexity less than 
\begin_inset Formula $r-1$
\end_inset

 where the complexity of the 
\begin_inset Formula $j$
\end_inset

th outcome is its number of non-zero coefficients.
 However, any ``non-zero'' coefficient can be arbitrarily close to zero.
 Thus, each column of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 will have 
\begin_inset Formula $r$
\end_inset

 
\emph on
exact
\emph default
 zeros.
 If necessary, the default mapping rule will then be applied to squash 
\begin_inset Formula $b_{p}-r$
\end_inset

 more cells to zero for the 
\begin_inset Formula $p$
\end_inset

th factor.
 Perhaps this mapping would better be attributed to the chapter on simple
 structure in Cureton and D'Agostino (1983).
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $2r$
\end_inset

 outcomes each of complexity 
\begin_inset Formula $r-2$
\end_inset

.
\begin_inset Quotes erd
\end_inset

 This mapping starts by finding the smallest cell in the first column of
 
\begin_inset Formula $\underline{\boldsymbol{\Upsilon}}$
\end_inset

 and squashes it to zero.
 Say this cell is 
\begin_inset Formula $\underline{\Upsilon_{j1}}$
\end_inset

.
 Then, the smallest nonzero cell in the 
\begin_inset Formula $j$
\end_inset

th row of 
\begin_inset Formula $\underline{\boldsymbol{\Upsilon}}$
\end_inset

 is also squashed to zero so that the 
\begin_inset Formula $j$
\end_inset

th outcome is of complexity 
\begin_inset Formula $r-2$
\end_inset

.
 This procedure is repeated for all columns to yield 
\begin_inset Formula $2r$
\end_inset

 outcomes each of complexity 
\begin_inset Formula $r-2$
\end_inset

, such that each factor has 
\begin_inset Formula $r-1$
\end_inset

 zeros.
 Finally, the default mapping rule is applied to squash 
\begin_inset Formula $b_{p}-\left(r-1\right)$
\end_inset

 more cells to zero for the 
\begin_inset Formula $p$
\end_inset

th factor.
\end_layout

\begin_layout Itemize
``Unit complexity basis (revisionist Butler 1969)''.
 Let the set of 
\begin_inset Quotes eld
\end_inset

best
\begin_inset Quotes erd
\end_inset

 indicators be the 
\begin_inset Formula $r$
\end_inset

 outcomes such that 
\begin_inset Formula $\underline{\Game_{jp}}=\max\left(\underline{\boldsymbol{\Game}_{p}}\right)$
\end_inset

 with the further proviso that this set consists of 
\begin_inset Formula $r$
\end_inset

 unique outcomes.
 Butler (1969), in essence, uses the phrase 
\begin_inset Quotes eld
\end_inset

the 
\begin_inset Formula $r$
\end_inset

 most distinguished outcomes
\begin_inset Quotes erd
\end_inset

 for this set and proposes to run the 
\begin_inset Formula $r$
\end_inset

 primary axes through them in EFA.
 This mapping rule preserves the largest coefficient for each of the 
\begin_inset Formula $r$
\end_inset

 outcomes in this set and 
\begin_inset Quotes eld
\end_inset

zeros out
\begin_inset Quotes erd
\end_inset

 all other coefficients in this set to yield 
\begin_inset Formula $r-1$
\end_inset

 zeros per factor concentrated among 
\begin_inset Formula $r$
\end_inset

 outcomes, yielding a 
\begin_inset Quotes eld
\end_inset

unit complexity basis
\begin_inset Quotes erd
\end_inset

 for the vector space of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 The default mapping rule is then applied to squash 
\begin_inset Formula $b_{p}-\left(r-1\right)$
\end_inset

 more cells to zero for the 
\begin_inset Formula $p$
\end_inset

th factor.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Set the maximum complexity for each outcome.
\begin_inset Quotes erd
\end_inset

 This mapping rule is similar to the default mapping rule, except that it
 is applied to the 
\emph on
rows
\emph default
 of 
\begin_inset Formula $\boldsymbol{\Upsilon}$
\end_inset

 rather than its columns.
 In general, 
\begin_inset Formula $\forall j$
\end_inset

, the user can choose 
\begin_inset Formula $b_{j}\in\left\{ 0,\dots,r-1\right\} $
\end_inset

 for the minimum number of zero coefficients in 
\begin_inset Formula $\boldsymbol{\beta}_{j}$
\end_inset

, and the complexity of the 
\begin_inset Formula $j$
\end_inset

th outcome is 
\begin_inset Formula $r-b_{j}$
\end_inset

.
 It is possible to choose the same complexity for all rows of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

.
 If the complexity of 
\begin_inset Formula $\boldsymbol{\beta}_{j}$
\end_inset

 is 
\begin_inset Formula $r-1\,\forall j$
\end_inset

, this restriction characterizes the main tenet of Thurstone's (1935) definition
 of simple structure.
 If the complexity of 
\begin_inset Formula $\boldsymbol{\beta}_{j}$
\end_inset

 is 
\begin_inset Formula $1\,\forall j$
\end_inset

, this restriction implies a perfect cluster configuration.
 Alternatively, 
\begin_inset Formula $b_{j}$
\end_inset

 can be specified on a row-by-row basis, as is shown in the dialog below,
 which will pop up if this maping rule is selected.
 Finally, the default mapping rule is applied to ensure that there are at
 least 
\begin_inset Formula $b_{p}$
\end_inset

 zeros for the 
\begin_inset Formula $p$
\end_inset

th factor.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/mapping_rule/slider.png
	width 3.25in

\end_inset


\begin_inset Graphics
	filename screenshots2/mapping_rule/complexity.png
	width 3.25in

\end_inset


\end_layout

\begin_layout Standard
Finally, in the case of SEFA, it is necessary to specify 
\begin_inset Formula $b_{p}\,\forall p$
\end_inset

.
 By default, 
\begin_inset Formula $b_{p}=r\,\forall p$
\end_inset

, which is the minimum that is necessary for identification of the nonzero
 parameters.
 However, it is possible to select 
\begin_inset Formula $b_{p}>r$
\end_inset

 and may be possible to select 
\begin_inset Formula $b_{p}=r-1$
\end_inset

 in some cases if identification of the relevant parameters can be accomplished
 in some other fashion.
 The following dialogs illustrate this mechanism, which is initialized when
 the box for 
\begin_inset Quotes eld
\end_inset

Change the number of zero coefficients required for each factor
\begin_inset Quotes erd
\end_inset

 is checked:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/zeros/sure.png
	width 3.5in

\end_inset


\begin_inset Graphics
	filename screenshots2/zeros/slider.png
	width 3in

\end_inset


\end_layout

\begin_layout Subsubsection
Change bounds on correlations among primary factors (first checkbox)
\begin_inset CommandInset label
LatexCommand label
name "sub:bounds_cormat"

\end_inset


\end_layout

\begin_layout Standard
This figure below illustrates a dialog that asks about bounds on the off-diagona
ls of 
\begin_inset Formula $\ddot{\boldsymbol{\Phi}}$
\end_inset

.
 If 
\begin_inset Formula $\ddot{r}\leq1$
\end_inset

, this question would not be asked, although if 
\begin_inset Formula $\ddot{r}=0$
\end_inset

, a similar dialogue would ask about bounds on the off-diagonals of 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

.
 If there were more factors, the editor window would have more rows, totalling
 
\begin_inset Formula $0.5\ddot{r}\left(\ddot{r}-1\right)$
\end_inset

.
\end_layout

\begin_layout Standard
The user is given an editor with columns for the lower and upper bounds
 on these correlations.
 The bounds cannot exceed 
\begin_inset Formula $\pm1$
\end_inset

 because they pertain to correlations.
 Here, I edited the admissable interval to 
\begin_inset Formula $\left[-0.9,0.9\right]$
\end_inset

, which is a largely irrelevant restriction.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/bounds_cormat/bounds_cormat.png
	height 2.5in

\end_inset


\end_layout

\begin_layout Subsubsection
Impose functional inequality restrictions
\begin_inset CommandInset label
LatexCommand label
name "sub:funky"

\end_inset


\end_layout

\begin_layout Standard
It is always important to keep in mind that FA
\begin_inset Formula $i$
\end_inset

R does something tantamount to restricted optimization and that the possibilitie
s for restrictions are endless.
 Hence, perhaps the most important feature of FA
\begin_inset Formula $i$
\end_inset

R is the ability to impose inequality restrictions on functions of multiple
 parameters.
 It is even possible to define your own restriction functions and pass them
 to the criteria argument of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions}
\end_layout

\end_inset

.
 In this subsection, I will only discuss the functional inequality restrictions
 that are pre-programmed in FA
\begin_inset Formula $i$
\end_inset

R.
 
\end_layout

\begin_layout Standard
Please refer to section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:definitions"

\end_inset

 for definitions of the factor contribution matrix, the generalized variance,
 and the effective variance.
 Also, let 
\begin_inset Formula $\mathbb{I}\left\{ \cdot\right\} $
\end_inset

 be the 
\begin_inset Quotes eld
\end_inset

indicator function
\begin_inset Quotes erd
\end_inset

, which equals 
\begin_inset Formula $1$
\end_inset

 if the condition represented by 
\begin_inset Formula $\cdot$
\end_inset

 is true and equals 
\begin_inset Formula $0$
\end_inset

 if the condition is false.
 In FA
\begin_inset Formula $i$
\end_inset

R, an inequality restriction function is a piecewise function that equals
 
\begin_inset Formula $-1$
\end_inset

 if the restriction is satisfied and equals some number greater than 
\begin_inset Formula $-1$
\end_inset

 if the the restriction is not satisfied.
 You do not need to worry too much about the return values for the case
 where the restriction is not satisfied.
\end_layout

\begin_layout Standard
When the box for 
\begin_inset Quotes eld
\end_inset

Impose functional inequality restrictions
\begin_inset Quotes erd
\end_inset

 (at level one) is checked, the following menu appears:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename screenshots2/constraints/menu.png
	width 6.5in

\end_inset


\end_layout

\begin_layout Standard
The menu would be similar at level two but will perhaps have fewer options.
 These restrictions are defined as follows:
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Factor contributions must respect row-wise order constraints.
\begin_inset Quotes erd
\end_inset

 Let 
\begin_inset Formula $\mathbf{G}$
\end_inset

 be a 
\begin_inset Formula $n\times r$
\end_inset

 matrix that is specified by the user to indicate the required ranks of
 the factor contributions within each row with larger factor contributions
 receiving smaller ranks.
 For example, 
\begin_inset Formula $\mathbf{G}_{j}$
\end_inset

 could be 
\begin_inset Formula $\begin{bmatrix}4 & 1 & 5 & 3 & 2\end{bmatrix}$
\end_inset

 to require that the second factor contribution in the 
\begin_inset Formula $j$
\end_inset

th row be biggest, the third factor contribution be smallest, etc.
 However, it is not necessary for the ranks to be unique.
 For example, 
\begin_inset Formula $\mathbf{G}_{j}$
\end_inset

 could be 
\begin_inset Formula $\begin{bmatrix}5 & 1 & 5 & 5 & 5\end{bmatrix}$
\end_inset

 to require that the second factor contribution in the 
\begin_inset Formula $j$
\end_inset

th row be biggest, while allowing the other ranks to be unrestricted.
 Such a specification would often be used in CFA or in a more 
\begin_inset Quotes eld
\end_inset

confirmatory
\begin_inset Quotes erd
\end_inset

 SEFA where the user has strong theoretical reason to believe that the 
\begin_inset Formula $j$
\end_inset

th outcome largely 
\begin_inset Quotes eld
\end_inset

measures
\begin_inset Quotes erd
\end_inset

 the 
\begin_inset Formula $p$
\end_inset

th factor and thus specifies that 
\begin_inset Formula $G_{jp}=1$
\end_inset

 and that 
\begin_inset Formula $G_{jq}=r\,\forall q\neq p$
\end_inset

.
 But keep in mind that, for example, 
\begin_inset Formula $\mathbf{G}_{j}=\begin{bmatrix}2 & 2 & 5 & 5 & 5\end{bmatrix}$
\end_inset

 is also valid and requires that the first two factor contributions in the
 
\begin_inset Formula $j$
\end_inset

th row be the top two without taking a position on whether the first is
 larger than the second.
 Conversely, 
\begin_inset Formula $\mathbf{G}_{j}=\begin{bmatrix}2 & 2 & 3 & 3 & 5\end{bmatrix}$
\end_inset

, for example, is invalid because it is impossible for the first four factor
 contributions to all be ranked in the top three.
\begin_inset Newline newline
\end_inset


\begin_inset Formula $\mathbf{G}$
\end_inset

 can be specified interactively in response to the following dialog:
\begin_inset Foot
status open

\begin_layout Plain Layout
This restriction can also be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, critieria = list("ranks
\backslash
_rows
\backslash
_1st"), methodArgs = list(row
\backslash
_ranks
\backslash
_1st = G))}
\end_layout

\end_inset

where 
\begin_inset Formula $\mathbf{G}$
\end_inset

 matrix is manually defined in the global environment.
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/constraints/rowranks.png

\end_inset


\begin_inset Newline newline
\end_inset

 Let 
\begin_inset Formula $\underrightarrow{\boldsymbol{\Game}}$
\end_inset

 be a factor contribution matrix that has been converted to ranks within
 rows.
 The function that imposes this constraint is formally defined as
\begin_inset Formula \begin{eqnarray*}
\frac{-1}{nr}\sum_{j=1}^{n}\sum_{p=1}^{r}\mathbb{I}\left\{ \underrightarrow{\Game_{jp}}\leq G_{jp}\right\}  & \in & \left[-1,0\right]\end{eqnarray*}

\end_inset

and thus equals 
\begin_inset Formula $-1$
\end_inset

 if and only if 
\begin_inset Formula $\underrightarrow{\boldsymbol{\Game}}$
\end_inset

 is consistent with 
\begin_inset Formula $\mathbf{G}$
\end_inset

 in every cell.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Factor contributions must respect column-wise order constraints.
\begin_inset Quotes erd
\end_inset

 Essentially, this constraint involves the same concept as the previous
 constraint, except that 
\begin_inset Formula $\underrightarrow{\boldsymbol{\Game}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{G}$
\end_inset

 are defined on the basis of column-wise ranks.
 I use the same notation as before but the matrices have different contents.
 For example, 
\begin_inset Formula $\mathbf{G}_{p}^{\prime}=\begin{bmatrix}3 & 3 & 3 & n & \dots & n\end{bmatrix}$
\end_inset

 would require that the first three outcomes have the three largest factor
 contributions on the 
\begin_inset Formula $p$
\end_inset

th factor.
 The remaining 
\begin_inset Formula $n-3$
\end_inset

 outcomes can be ranked in any fashion on the 
\begin_inset Formula $p$
\end_inset

th factor, provided that none is in the top three.
 Again, this mechanism would most often be used in CFA or in a more 
\begin_inset Quotes eld
\end_inset

confirmatory
\begin_inset Quotes erd
\end_inset

 SEFA.
 It is tempting to specify that 
\begin_inset Formula $G_{jp}=1$
\end_inset

 in order to make the 
\begin_inset Formula $p$
\end_inset

th factor closely related the to 
\begin_inset Formula $j$
\end_inset

th outcome, but there is a better mechanism for doing so, which is discussed
 next.
\begin_inset Newline newline
\end_inset


\begin_inset Formula $\mathbf{G}$
\end_inset

 can be specified interactively in response to the following dialog:
\begin_inset Foot
status open

\begin_layout Plain Layout
This restriction can also be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, critieria = list("ranks
\backslash
_cols
\backslash
_1st"), methodArgs = list(col
\backslash
_ranks
\backslash
_1st = G))}
\end_layout

\end_inset

where 
\begin_inset Formula $\mathbf{G}$
\end_inset

 matrix is manually defined in the global environment.
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/constraints/colranks.png

\end_inset


\begin_inset Newline newline
\end_inset

Let 
\begin_inset Formula $\underrightarrow{\boldsymbol{\Game}}$
\end_inset

 be a factor contribution matrix that has been converted to ranks within
 columns.
 The function that imposes this constraint is formally defined as
\begin_inset Formula \begin{eqnarray*}
\frac{-1}{nr}\sum_{j=1}^{n}\sum_{p=1}^{r}\mathbb{I}\left\{ \underrightarrow{\Game_{jp}}\leq G_{jp}\right\}  & \in & \left[-1,0\right]\end{eqnarray*}

\end_inset

and thus equals 
\begin_inset Formula $-1$
\end_inset

 if and only if 
\begin_inset Formula $\underrightarrow{\boldsymbol{\Game}}$
\end_inset

 is consistent with 
\begin_inset Formula $\mathbf{G}$
\end_inset

 in every cell.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Designate which outcome variable is the best indicator of each factor.
\begin_inset Quotes erd
\end_inset

 This criterion just is a special case of the previous one but is operationalize
d differently for better computational performance.
 In essence, one is merely requiring that 
\begin_inset Formula $G_{jp}=1$
\end_inset

 and 
\begin_inset Formula $G_{kp}=n\,\forall k\neq j$
\end_inset

 for any designated 
\begin_inset Formula $p$
\end_inset

.
 Hence, it is not necessary to impose such a restriction for every factor.
 This restriction would be used when the user believes that the 
\begin_inset Formula $j$
\end_inset

th outcome 
\emph on
is
\emph default
 the 
\begin_inset Formula $p$
\end_inset

th factor but measured with error.
 It may be fruitful to combine this restriction with the restriction that
 
\begin_inset Formula $\beta_{jq}=0\,\forall q\neq p$
\end_inset

 but doing so is not required.
 Thus, this restriction is weaker and presumably more realistic than the
 restriction that the 
\begin_inset Formula $j$
\end_inset

th variable is 
\begin_inset Quotes eld
\end_inset

exogenous
\begin_inset Quotes erd
\end_inset

 and measured without error, i.e.
\begin_inset space ~
\end_inset


\begin_inset Formula $\beta_{jp}=\mathbb{I}\left\{ q=p\right\} $
\end_inset

.
\begin_inset Newline newline
\end_inset

 These indicators can be specified interactively in response to the following
 dialog:
\begin_inset Foot
status open

\begin_layout Plain Layout
This restriction can also be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("indicators
\backslash
_1st"), methodArgs = list(indicators
\backslash
_1st = z))}
\end_layout

\end_inset

, where 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{z}
\end_layout

\end_inset

 is an integer vector with 
\begin_inset Formula $r$
\end_inset

 elements, each of which contains the row number of the best indicator of
 the 
\begin_inset Formula $p$
\end_inset

th factor, which can be 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{NA
\backslash
_integer
\backslash
_}
\end_layout

\end_inset

 to avoid constraining the 
\begin_inset Formula $p$
\end_inset

th factor.
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/constraints/indicators.png

\end_inset


\begin_inset Newline newline
\end_inset

The function that imposes this constraint is formally defined as as the
 average column-wise rank of the designated indicators (among factors with
 designated indicators) less two.
 This function ranges from 
\begin_inset Formula $-1$
\end_inset

 to 
\begin_inset Formula $n-2$
\end_inset

 and equals 
\begin_inset Formula $-1$
\end_inset

 if and only if the indicators have the largest factor contribution in their
 respective columns.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Reference factors at level 1 must have more effective variance than does
 the battery as a whole
\begin_inset Quotes erd
\end_inset

.
 The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced by from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("ev
\backslash
_RF
\backslash
_1st"))}
\end_layout

\end_inset

.
 
\end_layout

\end_inset


\begin_inset Formula \begin{eqnarray*}
\begin{cases}
-1 & \textrm{if\,}\left|\boldsymbol{\Psi}\right|^{\frac{1}{r}}\geq\left|\mathbf{R}\right|^{\frac{1}{n}}\\
\left|\mathbf{R}\right|^{\frac{1}{n}}-\left|\boldsymbol{\Psi}\right|^{\frac{1}{r}} & \textrm{otherwise}\end{cases} & \in & \left[-1,1\right],\end{eqnarray*}

\end_inset

This criterion loosely implies that the reference factors at level 1 be
 
\begin_inset Quotes eld
\end_inset

less correlated'' than is the configuration of outcomes in common factor
 space and encourages the primary axes to cut through the edges of the test
 configuration.
 This restriction is extremely weak and could be imposed in a more 
\begin_inset Quotes eld
\end_inset

exploratory
\begin_inset Quotes erd
\end_inset

 SEFA.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Primary factors at level 1 must have more effective variance than does the
 battery as a whole
\begin_inset Quotes erd
\end_inset

.
 The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced by from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("ev
\backslash
_PF
\backslash
_1st"))}
\end_layout

\end_inset

.
 
\end_layout

\end_inset


\begin_inset Formula \begin{eqnarray*}
\begin{cases}
-1 & \textrm{if\,}\left|\boldsymbol{\Phi}\right|^{\frac{1}{r}}\geq\left|\mathbf{R}\right|^{\frac{1}{n}}\\
\left|\mathbf{R}\right|^{\frac{1}{n}}-\left|\boldsymbol{\Phi}\right|^{\frac{1}{r}} & \textrm{otherwise}\end{cases} & \in & \left[-1,1\right],\end{eqnarray*}

\end_inset

and is similar to the previous criterion above except is more intuitive
 because the effective variance of the primary factors is at issue.
 In general, it seems that imposing this restriction on the primary factors
 is 
\emph on
stronger
\emph default
 than imposing it on the reference factors and tends to push the first-order
 axes farther out into the edges of the test configuration.
 It seems clear that Yates (1987) would have supported this restriction
 but does not specifically mention it.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Communalities must exceed all the factor contributions that constitute them.
\begin_inset Quotes erd
\end_inset

 The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced by from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("h2
\backslash
_over
\backslash
_FC
\backslash
_1st"))}
\end_layout

\end_inset

.
 
\end_layout

\end_inset

 
\begin_inset Formula \begin{eqnarray*}
\frac{-1}{nr}\sum_{j=1}^{n}\sum_{p=1}^{r}\mathbb{I}\left\{ h_{j}^{2}\geq\Game_{jp}\right\}  & \in & \left[-1,0\right],\end{eqnarray*}

\end_inset

which permits some negative suppressor variables but prohibits extreme situation
s such as that where one factor contribution is large and positive and another
 in that row is almost equally large in magnitude but negative.
 Overall, this restriction seems quite weak.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Best indicator of each factor must have non-negative factor contributions.
\begin_inset Quotes erd
\end_inset

 Let 
\begin_inset Formula $\underleftrightarrow{\boldsymbol{\Game}}$
\end_inset

 be the 
\begin_inset Formula $r\times r$
\end_inset

 submatrix of 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 whose rows contain the best indicators of each factor as defined by the
 column-maximums of 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

 with the additional proviso that the rows are unique.
 The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("distinguishability
\backslash
_1st")}
\end_layout

\end_inset

.
 
\end_layout

\end_inset


\begin_inset Formula \begin{eqnarray*}
\frac{-1}{r^{2}}\sum_{q=1}^{r}\sum_{p=1}^{r}\mathbb{I}\left\{ \underleftrightarrow{\Game_{qp}}\geq0\right\}  & \in & \left[-1,0\right],\end{eqnarray*}

\end_inset

and is stronger than the previous criterion and weaker than the next criterion.
 Although it prohibits negative suppressor variables among the best indicators,
 it permits any degree of suppression among the other outcome variables.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

No negative suppressor variables.
\begin_inset Quotes erd
\end_inset

 Let 
\begin_inset Formula $\Game^{\ast}\leq0$
\end_inset

 be the minimum factor contribution that the user is willing to accept,
 and thus wants all factor contributions to exceed this threshold to prohibit
 
\begin_inset Quotes eld
\end_inset

negative
\begin_inset Quotes erd
\end_inset

 suppressor variables but perhaps make some allowance for factor contributions
 to be slightly negative by chance.
 This constraint can be specified interactively via the following diaglog
 with 
\begin_inset Formula $\Game^{\ast}=-0.01$
\end_inset

:
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced at the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("no
\backslash
_neg
\backslash
_suppressors
\backslash
_1st"), methodArgs = list(FC
\backslash
_threshold
\backslash
_1st = -.01))}
\end_layout

\end_inset

 
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/constraints/nns.png

\end_inset


\begin_inset Newline newline
\end_inset

The function that imposes this constraint is formally defined as
\begin_inset Formula \begin{eqnarray*}
\frac{-1}{nr}\sum_{j=1}^{n}\sum_{p=1}^{r}\mathbb{I}\left\{ \Game_{jp}\geq\Game^{\ast}\right\}  & \in & \left[-1,0\right],\end{eqnarray*}

\end_inset

and is a fairly strong --- yet in many cases, reasonable --- restriction.
 Yates (1987, p.
\begin_inset space ~
\end_inset

119) essentially recommends it, albeit with some incorrect statements about
 the relationship between this restriction and the rest of the surrounding
 chapter.
\end_layout

\begin_layout Itemize
``Reference factors must have more generalized variance than do primary
 factors''.
 The function that imposes this constraint could be formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced by from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("gv
\backslash
_1st"))}
\end_layout

\end_inset

.
 
\end_layout

\end_inset

 
\begin_inset Formula \begin{eqnarray*}
\begin{cases}
-1 & \textrm{if\,}\left|\boldsymbol{\Phi}\right|\leq\left|\boldsymbol{\Psi}\right|\\
\left|\boldsymbol{\Phi}\right|-\left|\boldsymbol{\Psi}\right| & \textrm{otherwise}\end{cases} & \in & \left[-1,1\right]\end{eqnarray*}

\end_inset

but has a faster and substantively equivalent operationalization in the
 code.
 When 
\begin_inset Formula $r_{1}=2$
\end_inset

, 
\begin_inset Formula $\left|\boldsymbol{\Phi}\right|=\left|\boldsymbol{\Psi}\right|$
\end_inset

 by necessity, so this criterion can bind in the case when 
\begin_inset Formula $r\geq3$
\end_inset

.
 Also, this criterion necessarily holds when there is a single second-order
 factor.
 Yates (1987, p.
\begin_inset space ~
\end_inset

27) asserts that this restriction is a necessary condition of a useful factor
 analysis model, although counter-examples can be generated.
 With randomly drawn correlations from a uniform distribution on 
\begin_inset Formula $\left[-1,1\right]$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 is both positive definite and satisfies this restriction about 
\begin_inset Formula $25\%$
\end_inset

 of the time when 
\begin_inset Formula $r=3$
\end_inset

, 
\begin_inset Formula $5\%$
\end_inset

 of the time when 
\begin_inset Formula $r=4$
\end_inset

, 
\begin_inset Formula $0.5\%$
\end_inset

 of the time when 
\begin_inset Formula $r=5$
\end_inset

, and even less frequently for 
\begin_inset Formula $r>5$
\end_inset

.
 
\end_layout

\begin_layout Itemize
``Outcomes in hyperplanes have more effective variance than does the battery
 as a whole''.
 The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("cohyperplanarity
\backslash
_1st"))}
\end_layout

\end_inset

.
 
\end_layout

\end_inset

 
\begin_inset Formula \begin{eqnarray*}
\frac{-1}{r}\sum_{p=1}^{r}\mathbb{I}\left\{ \left|\overset{p}{\boldsymbol{\beta}}\boldsymbol{\Phi}\overset{p}{\boldsymbol{\beta}^{\prime}}+\overset{p}{\boldsymbol{\Theta}^{2}}\right|^{\frac{1}{b_{p}}}\geq\left|\mathbf{R}\right|^{\frac{1}{n}}\right\}  & \in & \left[-1,0\right],\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $\overset{p}{\boldsymbol{\beta}}$
\end_inset

 is the 
\begin_inset Formula $b_{p}\times r$
\end_inset

 submatrix of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 with exact zeros in the 
\begin_inset Formula $p$
\end_inset

th column and 
\begin_inset Formula $\overset{p}{\boldsymbol{\Theta}^{2}}$
\end_inset

 is the 
\begin_inset Formula $b_{p}\times b_{p}$
\end_inset

 diagonal submatrix of 
\begin_inset Formula $\boldsymbol{\Theta}^{2}$
\end_inset

 with the unique variances for these 
\begin_inset Formula $b_{p}$
\end_inset

 outcomes.
 Thus, this criterion loosely requires that the outcomes in the 
\begin_inset Formula $p$
\end_inset

th hyperplane be ``less correlated'' than is the battery as a whole (in
 common factor space) for all 
\begin_inset Formula $r$
\end_inset

 hyperplanes and is thus fairly strong.
 This constraint goes well with the revisionist Yates mapping rule discussed
 in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mapping_rule"

\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Minimum binary distance among columns of the logically negated loadings
 matrix.
\begin_inset Quotes erd
\end_inset

 Let 
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
sout{
\backslash
beta_{jp}}=
\backslash
begin{cases} 1 
\backslash
textrm{if}
\backslash
,
\backslash
beta_{jp}=0
\backslash

\backslash
 0 
\backslash
textrm{if}
\backslash
,
\backslash
beta_{jp}
\backslash
neq0
\backslash
end{cases}$
\end_layout

\end_inset

 be the 
\begin_inset Quotes eld
\end_inset

logically negated loadings matrix
\begin_inset Quotes erd
\end_inset

.
 The binary distance between two columns of the 
\begin_inset Quotes eld
\end_inset

logically negated loadings matrix
\begin_inset Quotes erd
\end_inset

 is defined as 
\begin_inset ERT
status open

\begin_layout Plain Layout

(see 
\backslash
Rcode{?dist})
\end_layout

\end_inset

 as 
\begin_inset Quotes eld
\end_inset

the 
\emph on
proportion
\emph default
 of bits in which only one is on amongst those in which at least one is
 on
\begin_inset Quotes erd
\end_inset

.
 In order to satisfy the theorem in Reiers
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
o{}
\end_layout

\end_inset

l (1950), the minimum binary distance betwen any two columns must be positive,
 but it is possible to require a larger minimum binary distance.
 
\begin_inset Newline newline
\end_inset

Let 
\begin_inset Formula $d^{\ast}$
\end_inset

 be the requisite minimum binary distance, which can be specified in response
 to the following dialog:
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/constraints/distance.png

\end_inset


\begin_inset Newline newline
\end_inset

Let 
\begin_inset Formula $d_{qp}$
\end_inset

 be the binary distance between the 
\begin_inset Formula $q$
\end_inset

th and 
\begin_inset Formula $p$
\end_inset

th columns of 
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
sout{
\backslash
boldsymbol{
\backslash
beta}}$
\end_layout

\end_inset

.
 The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can also be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, critieria = list("dist
\backslash
_cols
\backslash
_1st"), methodArgs = list(cutpoint
\backslash
_1st = 0.5))}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Formula \begin{eqnarray*}
\frac{-2}{r\left(r-1\right)}\sum_{q=1}^{r}\sum_{p\neq q}^{r}\mathbb{I}\left\{ d_{qp}\geq d^{\ast}\right\}  & \in & \left[-1,0\right]\end{eqnarray*}

\end_inset

and would most often be used in a more 
\begin_inset Quotes eld
\end_inset

exploratory
\begin_inset Quotes erd
\end_inset

 SEFA.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Generalized variance of the reproduced correlation matrix must be less than
 that of the sample correlation matrix.
\begin_inset Quotes erd
\end_inset

 The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("volume
\backslash
_1st"))}
\end_layout

\end_inset

.
 
\end_layout

\end_inset


\begin_inset Formula \begin{eqnarray*}
\begin{cases}
-1 & \textrm{if\,}\left|\mathbf{R}\right|\geq\left|\textrm{cor}\left(\mathbf{Y}\right)\right|\\
\left|\textrm{cor}\left(\mathbf{Y}\right)\right|-\left|\mathbf{R}\right| & \textrm{otherwise}\end{cases} & \in & \left[-1,1\right],\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $\left|\textrm{cor}\left(\mathbf{Y}\right)\right|$
\end_inset

 is the determinant of the sample correlation matrix.
 This restriction is pretty weak.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Prohibit some coefficients from being zero.
\begin_inset Quotes erd
\end_inset

 This restriction is relevant only for SEFA, where it is possible that the
 mapping rule will map some coefficient to zero that theoretically should
 not be zero.
 The most common case where this restriction is helpful is when equality
 restrictions are impose on two coefficients, and one presumably intends
 that they both be nonzero.
 The genetic algorithm would otherwise tend to make both zero and thereby
 satisfy two restrictions the easy way.
\begin_inset Newline newline
\end_inset

Let 
\begin_inset Formula $\mathbf{B}$
\end_inset

 be a matrix such that 
\begin_inset Formula $B_{jp}=1$
\end_inset

 if 
\begin_inset Formula $\beta_{jp}$
\end_inset

 must not be zero and equals zero otherwise, which can be specified in response
 to the following dialog:
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/constraints/blocks.png

\end_inset


\begin_inset Newline newline
\end_inset

The function that imposes this constraint is formally defined as
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can also be enforced at the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{make
\backslash
_restrictions(*, criteria = list("block
\backslash
_1st"), methodArgs = list(blockers = B))}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Formula \begin{eqnarray*}
\frac{-1}{\sum_{j=1}^{n}\sum_{p=1}^{r}B_{jp}}\sum_{j=1}^{n}\sum_{p=1}^{r}\mathbb{I}\left\{ B_{jp}=1\right\} \mathbb{I}\left\{ \beta_{jp}\neq0\right\}  & \in & \left[-1,0\right]\end{eqnarray*}

\end_inset

and equals 
\begin_inset Formula $-1$
\end_inset

 if and only if none of the prohibited coefficients are zero.
\end_layout

\begin_layout Standard
Note that it is possible to select (or specify at the command line) more
 than one of these criteria as constraints in the lexical optimization process.
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Exploratory Factor Analysis via 
\family typewriter
Factnal()
\family default
 and 
\family typewriter
Rotate()
\end_layout

\begin_layout Standard
To start this sequence, I typed the command
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
Rcode{man <- make
\backslash
_manifest(covmat = Harman74.cor)}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
Rcode{res <- make
\backslash
_restrictions(manifest = man, factors = 5, model = "EFA")}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
Rcode{EFA <- Factanal(manifest = man, restrictions = res)}
\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Factor Extraction
\end_layout

\begin_layout Standard
I use 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 to indicate the preliminary pattern matrix to estimate when the preliminary
 factors are orthogonal.
 The above sequence of commands will estimate the EFA model under the assumption
s that 
\begin_inset Formula $\boldsymbol{\Phi}=\mathbf{I}$
\end_inset

 and that 
\begin_inset Formula $\boldsymbol{\Lambda}^{\prime}\boldsymbol{\Theta}^{-2}\boldsymbol{\Lambda}$
\end_inset

 is diagonal using the maximum likelihood discrepancy function.
 If a different discrepancy function were specified, then the EFA model
 would be estimated under the assumptions that 
\begin_inset Formula $\boldsymbol{\Phi}=\mathbf{I}$
\end_inset

 and that 
\begin_inset Formula $\boldsymbol{\Lambda}=\begin{bmatrix}\boldsymbol{\Lambda}_{1}\\
\boldsymbol{\Lambda}_{2}\end{bmatrix}$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{\Lambda}_{1}$
\end_inset

 is a 
\begin_inset Formula $r\times r$
\end_inset

 matrix with zeros above its diagonal.
 
\end_layout

\begin_layout Subsection
Factor Transformation
\end_layout

\begin_layout Standard
Note that regardless of how the EFA model was estimated, the preliminary
 factors will have the noncanonical form where 
\begin_inset Formula $\boldsymbol{\Lambda}=\begin{bmatrix}\boldsymbol{\Lambda}_{1}\\
\boldsymbol{\Lambda}_{2}\end{bmatrix}$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{\Lambda}_{1}$
\end_inset

 is a 
\begin_inset Formula $r\times r$
\end_inset

 matrix with zeros above its diagonal.
 After verifying that a EFA model with 
\begin_inset Formula $r$
\end_inset

 factors fits the data reasonably well, there were no near-Heywood cases,
 etc., the next task is to choose a transformation of the preliminary factors.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\boldsymbol{\Phi}=\mathbf{T}^{\prime}\mathbf{T}$
\end_inset

 where 
\begin_inset Formula $\mathbf{T}$
\end_inset

 is a 
\begin_inset Formula $r\times r$
\end_inset

 transformation matrix with unit-length columns (not rows).
 The factor transformation step chooses 
\begin_inset Formula $\mathbf{T}$
\end_inset

 so so that some (lexical) objective function is 
\emph on
minimized
\emph default
.
 I initiated this sequence with
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash
 
\backslash
Rcode{EFA
\backslash
_rotated <- Rotate(EFA)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
WARNING: The subsequent pop-up menus are presented here in the logical order,
 which is different than the order in which they will appear when calling
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate()}
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsubsection
Functional inequality restrictions
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbb{I}\left\{ \cdot\right\} $
\end_inset

 be the 
\begin_inset Quotes eld
\end_inset

indicator function
\begin_inset Quotes erd
\end_inset

, which equals 
\begin_inset Formula $1$
\end_inset

 if the condition represented by 
\begin_inset Formula $\cdot$
\end_inset

 is true and equals 
\begin_inset Formula $0$
\end_inset

 if the condition is false.
 In FA
\begin_inset Formula $i$
\end_inset

R, an inequality restriction function is a piecewise function that equals
 
\begin_inset Formula $-1$
\end_inset

 if the restriction is satisfied and equals some number greater than 
\begin_inset Formula $-1$
\end_inset

 if the the restriction is not satisfied.
 You do not need to worry too much about the return values for the case
 where the restriction is not satisfied.
\end_layout

\begin_layout Standard
One such inequality restriction is mandatory and is used to prevent factor
 collapse.
 The function that imposes this constraint is formally defined as
\begin_inset Formula \begin{eqnarray*}
\begin{cases}
-1 & \textrm{if\,}\left|\boldsymbol{\Phi}\right|^{\frac{1}{r}}\geq v^{\ast}\\
v^{\ast}-\left|\boldsymbol{\Phi}\right|^{\frac{1}{r}} & \textrm{otherwise}\end{cases} & \in & \left[-1,1\right],\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $v^{\ast}>0$
\end_inset

 is the minimum acceptable effective variance for the primary factors.
 Please refer to section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:definitions"

\end_inset

 for the definition of effective variance.
 One can specify 
\begin_inset Formula $v^{\ast}$
\end_inset

 by responding to the following dialog:
\begin_inset Foot
status open

\begin_layout Plain Layout
The corresponding pop-up menu can be avoided from the command line with
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate(EFA, criteria = list("no
\backslash
_factor
\backslash
_collapse"), methodArgs = list(nfc
\backslash
_threshold = .3))}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename screenshots2/EFA/nfc.png

\end_inset


\end_layout

\begin_layout Standard
A value of 
\begin_inset Formula $v^{\ast}=0.3$
\end_inset

 is quite weak and in the 
\begin_inset Formula $r=2$
\end_inset

 case would permit the off-diagonal of 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

 to be up to 
\begin_inset Formula $\pm0.954$
\end_inset

, which only precludes 
\emph on
literal
\emph default
 factor collapse.
 One deliberately nice property of defining the restriction with respect
 to the effective variance is that the same 
\begin_inset Formula $v^{\ast}$
\end_inset

 is more-or-less reasonable regardless of 
\begin_inset Formula $r$
\end_inset

.
\end_layout

\begin_layout Standard
The following menu is similar to that in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:funky"

\end_inset

, which offered choices for functional inequality restrictions on SEFA and
 CFA models.
 Except for the first two choices, the definitions of the criteria and subsequen
t pop-up menus are the same; only the two that differ will be discussed
 in this subsection.
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename screenshots2/EFA/menu.png
	width 6.5in

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Bounds on correlations among primary factors.
\begin_inset Quotes erd
\end_inset

 This restriction is conceptually simple and merely places lower and / or
 upper bounds on all off-diagonals of 
\begin_inset Formula $\boldsymbol{\Phi}=\mathbf{T}^{\prime}\mathbf{T}$
\end_inset

.
 However, because the objective function is minimized over the cells of
 
\begin_inset Formula $\mathbf{T}$
\end_inset

 instead of 
\begin_inset Formula $\boldsymbol{\Phi}$
\end_inset

, we have to use a constraint function to accomplish this goal.
 Let 
\begin_inset Formula $\underline{\Phi}$
\end_inset

 be the minimum acceptable factor correlation and let 
\begin_inset Formula $\overline{\Phi}$
\end_inset

 be the maximum acceptable factor correlation, which can be specified interactiv
ely as follows:
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can also be enforced from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate(EFA, criteria = list("limit
\backslash
_correlations"), methodArgs(lower = -.1, upper = 1))}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/lower.png
	width 3in

\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/upper.png
	width 3in

\end_inset


\begin_inset Newline newline
\end_inset

The function that imposes this constraint returns 
\begin_inset Formula $-1$
\end_inset

 if 
\begin_inset Formula $\underline{\Phi}\leq\Phi_{pq}\leq\overline{\Phi}\,\forall p>q$
\end_inset

 and otherwise returns distance between the relevant bound the the correlation
 that most egregiously fails to satisfy these bounds.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Positive manifold.
\begin_inset Quotes erd
\end_inset

 Similarly, this restriction merely places a lower bound on 
\begin_inset Formula $\Upsilon_{jp}\,\forall j,p$
\end_inset

.
 Let 
\begin_inset Formula $\Upsilon^{\ast}\leq0$
\end_inset

 be this lower bound, which can be specified interactively by responding
 the to following dialog:
\begin_inset Foot
status open

\begin_layout Plain Layout
This constraint can be enforced at the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate(EFA, criteria = list("positive
\backslash
_manifold"), methodArgs(pm
\backslash
_threshold = -0.1))}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/pm.png

\end_inset


\begin_inset Newline newline
\end_inset

The function that imposes this constraint is formally defined as
\begin_inset Formula \begin{eqnarray*}
\frac{-1}{nr}\sum_{j=1}^{n}\sum_{p=1}^{r}\mathbb{I}\left\{ \Upsilon_{jp}\geq\Upsilon^{\ast}\right\}  & \in & \left[-1,0\right]\end{eqnarray*}

\end_inset

and hence is satisfied if and only if the proposed 
\begin_inset Formula $\mathbf{T}$
\end_inset

 yields a 
\begin_inset Quotes eld
\end_inset

positive
\begin_inset Quotes erd
\end_inset

 manifold.
\end_layout

\begin_layout Subsubsection
The ultimate analytic criterion
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename screenshots2/EFA/criteria1.png

\end_inset


\end_layout

\begin_layout Standard
The next step is to choose the ultimate criterion for lexical optimization,
 as shown in the above dialog box.
 These criteria are defined as follows:
\end_layout

\begin_layout Itemize
phi: This criterion was proposed by Thurstone (1935) to numerically characterize
 simple structure when it reaches its theoretical minimum of (log) zero.
 The criterion is formally defined as
\begin_inset Formula \begin{eqnarray*}
 & \ln\left(\sum_{j=1}^{n}\exp\left(\frac{1}{c}\sum_{p=1}^{r_{1}}\ln\left(\Upsilon_{jp}^{2}\right)\right)\right),\end{eqnarray*}

\end_inset

which is equal to logarithm of 
\begin_inset Formula $\phi$
\end_inset

 as defined by Thurstone (1935) when 
\begin_inset Formula $c=1$
\end_inset

.
 Thurstone suggested that choosing 
\begin_inset Formula $c$
\end_inset

 to be greater than 
\begin_inset Formula $1.0$
\end_inset

 could yield better results by lessening the pressure to get one near-zero
 into each row of 
\begin_inset Formula $\boldsymbol{\Upsilon}$
\end_inset

 and increasing the pressure to get more than one near-zero into some rows
 of 
\begin_inset Formula $\boldsymbol{\Upsilon}$
\end_inset

.
 If Thurstone's criterion is used, the following dialog box will appear,
 prompting the user for 
\begin_inset Formula $c$
\end_inset

:
\begin_inset Foot
status open

\begin_layout Plain Layout
This pop-up menu can be avoided from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate(EFA, critieria = list("phi"), methodArgs(c = 1))}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/c.png

\end_inset


\end_layout

\begin_layout Itemize
varphi: This criterion is a generalization of Thurstone's 
\begin_inset Formula $\phi$
\end_inset

.
 Let 
\begin_inset Formula $\overrightarrow{\boldsymbol{\Upsilon}}$
\end_inset

 be a matrix of reference structure correlations where each row is independently
 sorted in increasing magnitude, and let 
\begin_inset Formula $\underset{-\left[1:p\right]}{\overrightarrow{\phi}}$
\end_inset

 be Thurstone's criterion (with 
\begin_inset Formula $c=1$
\end_inset

) calculated on 
\begin_inset Formula $\overrightarrow{\boldsymbol{\Upsilon}}$
\end_inset

, excluding the first through the 
\begin_inset Formula $p$
\end_inset

th column of 
\begin_inset Formula $\overrightarrow{\boldsymbol{\Upsilon}}$
\end_inset

.
 Then define 
\begin_inset Formula $\varphi=\ln\left(\phi+\sum_{p=1}^{r-2}w_{p}\underset{-\left[1:p\right]}{\overrightarrow{\phi}}\right)$
\end_inset

, where 
\begin_inset Formula $w_{p}\in\left[0,1\right]$
\end_inset

 is the weight the analyst specifies for 
\begin_inset Formula $\underset{-\left[1:p\right]}{\overrightarrow{\phi}}$
\end_inset

 relative to a unit weight placed on 
\begin_inset Formula $\phi$
\end_inset

.
 At one extreme, if 
\begin_inset Formula $w_{p}=0\,\forall p$
\end_inset

, then 
\begin_inset Formula $\varphi=\phi$
\end_inset

.
 At the other extreme, if 
\begin_inset Formula $w_{p}=1\,\forall p$
\end_inset

, then the analyst favors a perfect cluster configuration, where three is
 only one non-zero coefficient per test.
 An ``objective'' alternative to specifying weights is to specify that the
 weights are a function of 
\begin_inset Formula $\overrightarrow{\boldsymbol{\Upsilon}}$
\end_inset

, such as 
\begin_inset Formula $w_{p}=1-\max\left\{ \left(\overrightarrow{\boldsymbol{\Upsilon}}_{p+1}\right)^{2}\right\} ^{\frac{1}{2}}$
\end_inset

 to gradually reduce the weight as 
\begin_inset Formula $p$
\end_inset

 increases.
 These weights can be specified interactively
\begin_inset Foot
status open

\begin_layout Plain Layout
These pop-up menus can be avoided from the command line with 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate(EFA, criteria = list("varphi"), methodArgs(w = rep(0.5, 4))}
\end_layout

\end_inset

 to weight all subsequent columns at half th weight of the first, for example.
 Or, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{w}
\end_layout

\end_inset

 can be any negative number to indicate dynamic weights.
\end_layout

\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/weights1.png
	width 3in

\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/weights2.png
	width 3in

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Itemize
minimaximin: This criterion attempts to satisfy Thurstone's definition of
 simple structure by choosing 
\begin_inset Formula $\mathbf{T}$
\end_inset

 so that all outcomes have at least one near-zero reference structure correlatio
n.
 The criterion is formally defined as 
\begin_inset Formula \begin{eqnarray*}
 & \ln\left(\max\left\{ \min\left\{ \Upsilon_{1}^{2}\right\} ,\min\left\{ \Upsilon_{2}^{2}\right\} ,\dots,\min\left\{ \Upsilon_{n}^{2}\right\} \right\} \right).\end{eqnarray*}

\end_inset

Thus, the (log of the) maximum of the minimums of the squared rows of 
\begin_inset Formula $\boldsymbol{\Upsilon}$
\end_inset

 is minimized.
\end_layout

\begin_layout Itemize
LS: This criterion is called the Loading Simplicy Index in Lorenzo-Seva
 (2003).
 The derivation of it is not complicated but involves a lot of notation
 not previously introduced here, so the reader is refered to Lorenzo-Seva
 (2003) for details.
 Simply put, it reaches its optimum of (negative) 
\begin_inset Formula $1.0$
\end_inset

 when 
\begin_inset Formula $\boldsymbol{\Upsilon}$
\end_inset

 exhibits a perfect cluster configuration.
 Although Lorenzo-Seva (2003) defines the Loading Simplicity Index in terms
 of the primary pattern matrix, it is invariant to the column-scale of the
 primary pattern matrix and thus can arbitrarily be defined for the reference
 structure matrix as well.
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Some oblique criterion from the GPArotation package.
\begin_inset Quotes erd
\end_inset

 If this option is marked, then the following dialog box appears, unless
 the name of the criterion is specified in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{criteria}
\end_layout

\end_inset

 in the call to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate}
\end_layout

\end_inset

, e.g.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{Rotate(EFA, criteria = list("quartimin"))}
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/criteria2.png

\end_inset


\begin_inset Newline newline
\end_inset

These criteria are all defined in Bernaards and Jennrich (2006) and documented
 in the GPArotation package.
 The versions in FA
\begin_inset Formula $i$
\end_inset

R work the same way, with four exceptions.
 First, and most importantly, FA
\begin_inset Formula $i$
\end_inset

R minimizes these criteria subjects to the aforementioned restrictions.
 Second, if the criterion has any additional arguments, they can be specified
 in a corresponding pop-up menu (or specified in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{methodArgs}
\end_layout

\end_inset

, as in the GPArotation library).
 Third, the partially-specified target implementation allows the partially-speci
fied target matrix to have 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{NA}
\end_layout

\end_inset

 in cells that are not targeted, instead of specifying a separate weight
 matrix of zeros and ones.
 Fourth, in FA
\begin_inset Formula $i$
\end_inset

R the criteria defined in the GPArotation package can also be invoked on
 
\begin_inset Formula $\boldsymbol{\Upsilon}$
\end_inset

 or 
\begin_inset Formula $\boldsymbol{\Game}$
\end_inset

, instead of 
\begin_inset Formula $\boldsymbol{\beta}$
\end_inset

 by specifying 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{matrix = "RS"}
\end_layout

\end_inset

 or 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{matrix = "FC"}
\end_layout

\end_inset

 as an element of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Rcode{methodArgs}
\end_layout

\end_inset

 or by responding to this dialog:
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename screenshots2/EFA/matrix.png

\end_inset


\end_layout

\begin_layout Section
References
\end_layout

\begin_layout Standard

\size small
Butler, J.M.
 1969.
 ``Simple Structure Reconsidered: Distinguishability and Invariance in Factor
 Analysis.'' 
\emph on
Multivariate Behavioral Research
\emph default
 4(1):5–28.
\end_layout

\begin_layout Standard

\size small
Goodrich, B.
 2008a.
 ``SEFA
\begin_inset Formula $i$
\end_inset

R So Far.'' Unpublished manuscript available from the FAiR wiki 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://wiki.r-project.org/rwiki/doku.php?id=packages:cran:fair
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\size small
Goodrich, B.
 2008b.
 ``Analytic Transformation of Factors in FA
\begin_inset Formula $i$
\end_inset

R.'' Unwritten manuscript.
 Email me about it.
\end_layout

\begin_layout Standard

\size small
Howe, W.G.
 1955.
 Some Contributions to Factor Analysis.
 Technical report ORNL-1919, Oak Ridge National Lab., Tenn.
\end_layout

\begin_layout Standard

\size small
Lorenzo-Seva, U.
 2003.
 “A factor simplicity index.” 
\emph on
Psychometrika
\emph default
 68(1):49–60.
\end_layout

\begin_layout Standard

\size small
Pe
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
~{n}
\end_layout

\end_inset

a, D.
 and J.
 Rodr
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'{i}
\end_layout

\end_inset

guez.
 2003.
 ``Descriptive measures of multivariate scatter and linear dependence.''
 
\emph on
Journal of Multivariate Analysis
\emph default
 85(2):361–374.
\end_layout

\begin_layout Standard

\size small
Thurstone, L.L.
 1935.
 
\emph on
The vectors of mind: multiple-factor analysis for the isolation of primary
 traits
\emph default
.
 University of Chicago Press.
\end_layout

\begin_layout Standard

\size small
Yates, A.
 1987.
 
\emph on
Multivariate exploratory data analysis: A perspective on exploratory factor
 analysis
\emph default
.
 State University of New York Press.
\end_layout

\end_body
\end_document
